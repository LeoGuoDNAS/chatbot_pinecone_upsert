<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head>

  <script type="text/javascript" language="JavaScript">
    //<![CDATA[
    function reDo() {
      if (innerWidth != origWidth || innerHeight != origHeight)
        location.reload();
    }
    if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
      origWidth = innerWidth;
      origHeight = innerHeight;
      onresize = reDo;
    }
    onerror = null;
  //]]>
  </script>
  <style type="text/css">/*<![CDATA[*/

    < !-- div.WebHelpPopupMenu {
      position: absolute;
      left: 0px;
      top: 0px;
      z-index: 4;
      visibility: hidden;
    }

    p.WebHelpNavBar {
      text-align: right;
    }

    -->
  
/*]]>*/</style>

  <script type="text/javascript">//<![CDATA[

    gRootRelPath = ".";
    gCommonRootRelPath = ".";
    gTopicId = "2.18.20.0_13";
  
//]]></script>

  <script type="text/javascript" src="./template/scripts/rh.min.js"></script>
  <script type="text/javascript" src="./template/scripts/common.min.js"></script>
  <script type="text/javascript" src="./template/scripts/topic.min.js"></script>
  <script type="text/javascript" src="./template/scripts/topicwidgets.min.js"></script>
<script type="text/javascript" src="./whxdata/projectsettings.js"></script>
  <link rel="stylesheet" type="text/css" href="./template/styles/topic.min.css"/>
  <link rel="stylesheet" type="text/css" href="./template/single_page/topicheader.css"/>
  <meta name="topic-status" content="Draft"/>

  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <meta name="generator" content="Adobe RoboHelp 2020"/>
  <title>Registry Avalara Web Services</title>
  <link rel="StyleSheet" href="assets/css/sampro.css" type="text/css"/>
  <meta name="rh-index-keywords" content="sales tax,Avalara,sys-avalara,web service Avalara"/>
</head>

<body>
  <div class="topic-header rh-hide" id="rh-topic-header">
    <div class="logo">
    </div>
    <div class="nav">
      <div class="title" title="Registry Avalara Web Services">
        <span>Registry Avalara Web Services</span>
      </div>
      <div class="gotohome" title="Click here to see this page in full context">
        <a href="#" onclick="rh._.goToFullLayout()">Click here to see this page in full context</a>
      </div>
    </div>
  </div>
  <div class="topic-header-shadow rh-hide" id="rh-topic-header-shadow"></div>



  <h1>Registry Avalara Web Services</h1>
  <h3>Purpose:</h3>
  <p>These registries support an alternative method of computing sales tax on AR Invoices using the Avalara Web Service Integration instead of SAMPro&#39;s internal computations. This functionality is currently supported for Sales Tax and Tax Exempt invoices, but not for Use tax computation. An advantage of using Avalara is that they will provide the tax reporting to supported districts. After obtaining your license and credentials from Avalara, the following registry must be set to enable the Avalara Web Integration. It is required that testing in a &#39;sandbox&#39; test system be conducted before running live.</p>
  <p>See <a href="Avalara_Web_Services_Overview.htm">Avalara Web Service Overview</a> for additional setup and configuration details.</p>
  <p><strong>Note: The AvaWebHost and AvaWebPort registry entries need to be specified at the sys-avalara level. Specifying these at the company, security, group or user level (i.e. sys-avalara-company:1) will not function properly when attempting to call the AvalaraWeb web service.</strong></p>
  <h3><span style="font-weight: bold;">Registries to Turn on Avalara Web Integration</span></h3>
  <p><span style="font-weight: bold;">Registry Id:</span> sys-ffv-global-settings</p>
  <p><span style="font-weight: bold;">Setting Key:</span> UseExternalTaxService  <span style="font-weight: bold;">Setting Value:</span> true</p>
  <p>This registry is the master switch to enable the use of the Avalara Web Integration for tax computation instead of SAMPro&#39;s internal tax is computation. If it is set to false, the Site Address validation may still be conducted provided that the Avalara Account information is properly defined.</p>
  <p><span style="font-weight: bold;">Setting Key:</span> TaxServiceProvider   <span style="font-weight: bold;">Setting Value:</span> Avalara</p>
  <p>This registry specifies that the Avalara Web Service Integration is used for the tax computation.</p>
  <h3>Registry To Specify Avalara Origin Country</h3>
  <p style="margin-left: 8px;">This registry option should be made by companies wishing to do business in other countries (i.e., Canada).</p>
  <p style="margin-left: 8px;"><span style="font-weight: bold;">Registry Id:</span> sys-avalara</p>
  <p style="margin-left: 8px;"><span style="font-weight: bold;">Setting Key:</span> OriginAddressCountry  <span style="font-weight: bold;">Setting Value:</span> <span style="font-style: italic;">AvalaraCountryCode</span></p>
  <p style="margin-left: 48px; text-decoration: underline; ">For example, US companies also doing business in Canada would make the following entry:</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Registry Id:</span> sys-avalara</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Setting Key:</span> OriginAddressCountry  <span style="font-weight: bold;">Setting Value:</span> US</p>
  <h3>Registry to Configure or Enable / Disable Avalara Web Service by Company</h3>
  <p>This release supports optional registry settings that enable company-specific settings within a multi-tenant database (Intercompany).</p>
  <p>Company-specific settings provide replacement values for any standard Avalara setting found in the sys-avalara registry.  It is NOT necessary to completely define all settings in the company-specific registry.  You only need to include those that are different from the standard (sys-avalara) settings.  This allows different Avalara Account and License numbers to be specified, or for the Avalara Web functionality to be disabled for one or more Companies within the SAMPro database.</p>
  <p>Registry Id is formatted as sys-avalara-company:<span style="font-style: italic;">CompanyId</span></p>
  <p style="margin-left: 48px; text-decoration: underline; ">Example: Disable Tax Service for Company 01:</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Id:</span> sys-avalara-company:01</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Setting Key:</span> TaxServiceDisabled    <span style="font-weight: bold;">Setting Value:</span> true</p>
  <p style="margin-left: 48px; text-decoration: underline; ">Example: Specify Different License and Account Number for Company 02</p>
  <p style="margin-left: 48px;">Note that this registry assumes that the ProductionEnvironment, CompanyCode and OriginAddress options are set in the base sys-avalara registry.</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Id:</span> sys-avalara-company:02</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Setting Key:</span> Account   <span style="font-weight: bold;">Setting Value:</span> 123456789</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Setting Key:</span> License   <span style="font-weight: bold;">Setting Value:</span> ABC123456789</p>
  <h3>Registries to Define Avalara Web Service Account and Posting Information</h3>
  <p><span style="font-weight: bold;">Registry Id:</span> sys-avalara  (this registry supports via sys-avalara-<span style="font-style: italic;">securityid entries)</span></p>
  <p><span style="font-weight: bold;">Setting Key:</span> ProductionEnvironment  <span style="font-weight: bold;">Setting Value:</span> true  (default is false)</p>
  <p>This option is set to true if actual live is being sent. It should be set to false if this data is being used for &#39;sandbox&#39; testing.</p>
  <p><span style="font-weight: bold;">Setting Key:</span>  Account   <span style="font-weight: bold;">Setting Value:</span> <span style="font-style: italic;">as provided by Avalara</span></p>
  <p><span style="font-style: italic; font-weight: bold;">S</span><span style="font-weight: bold;">etting Key:</span>  License   <span style="font-weight: bold;">Setting Value:</span> <span style="font-style: italic;">as provided by Avalara</span></p>
  <p><span style="font-weight: bold;">Setting Key:</span> CompanyCode    <span style="font-weight: bold;">Setting Value:</span><span style="font-style: italic; 
															 font-weight: bold;"> </span><span style="font-style: italic;">as provided by Aralara</span></p>
  <p>The Setting Values for the Account, License and CompanyCode keys are created during Avalara setup. The CompanyCode setting supports Intercompany configurations; it is passed with each call to Avalara.</p>
  <p><span style="font-style: italic; font-weight: bold;">S</span><span style="font-weight: bold;">etting Key:</span>  OriginAddressLine1   <span style="font-weight: bold;">Setting Value:</span> <span style="font-style: italic;">street address</span></p>
  <p><span style="font-style: italic;">T</span>he origin or ship-from street address.</p>
  <p><span style="font-style: italic; font-weight: bold;">S</span><span style="font-weight: bold;">etting Key:</span>  OriginAddressCity   <span style="font-weight: bold;">Setting Value:</span> <span style="font-style: italic;">city</span></p>
  <p>The origin or ship-from city.</p>
  <p><span style="font-style: italic; font-weight: bold;">S</span><span style="font-weight: bold;">etting Key:</span>  OriginAddressState   <span style="font-weight: bold;">Setting Value:</span> <span style="font-style: italic;">2 character state code</span></p>
  <p><span style="font-style: italic;">T</span>he origin or ship-from state or province two character abbreviation.</p>
  <p><span style="font-style: italic; font-weight: bold;">S</span><span style="font-weight: bold;">etting Key:</span>  OriginAddressPostalCode   <span style="font-weight: bold;">Setting Value:</span> <span style="font-style: italic;">postal/zip code</span></p>
  <p>The origin or ship-from Postal Code. Use the: five digit ZIP Code (12345), nine digit ZIP+4 Code (12345-6789) or six character Canadian Postal Code (A1B 2C3)</p>
  <p><span style="font-weight: bold;">Setting Key:</span> TaxAuthorityGLAccountId  <span style="font-weight: bold;">Setting Value:</span> <span style="font-style: italic;">A valid GL Account Id </span></p>
  <p>The sales tax liability account to be credited. Double-click on this field to select from a list of GL Accounts. This registry may be overridden on a state by state basis as defined in the following option.</p>
  <p><span style="font-weight: bold;">Setting Key:</span> TaxAuthorityGLAccountId~<span style="font-style: italic;">StateCode</span>  <span style="font-weight: bold;">Setting Value:</span> <span style="font-style: italic;">A valid GL Account Id </span></p>
  <p style="font-style: italic; margin-left: 48px;">Example: To specify a different GL Account for Ohio invoices:</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Setting Key:</span> TaxAuthorityGLAccountId~OH  <span style="font-weight: bold;">Setting Value:</span> 201500</p>
  <h3><span style="font-weight: bold;">Exempt Codes</span></h3>
  <p><span style="font-weight: bold;">Setting Key:</span> DefaultExemptEntityCode   <span style="font-weight: bold;">Setting Value:</span>  G  (or as defined by Avalara)</p>
  <h3>Job Specific Avalara Exempt Codes</h3>
  <p>In previous releases, all exempt jobs used the sys-avalara registry setting for DefaultExemptEntityCode.  In this release, an option allows for job-specific Exempt Entity Codes using the following registry AND by setting the appropriate Job User Field.</p>
  <p><span style="font-weight: bold;">Registry Id:</span> sys-avalara</p>
  <p><span style="font-weight: bold;">Setting Key:</span> ExemptEntityCodeUserField  <span style="font-weight: bold;">Setting Value</span>: <span style="font-style: italic;">JobUserFieldNumber</span></p>
  <p style="margin-left: 48px;">Example: Use Job User field 10 to provide specify the GL Entity Id that overrides the GL Entity specified by the DefaultExemptEntityCode registry option:</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Setting Key:</span> ExemptEntityCodeUserField  <span style="font-weight: bold;">Setting Value</span>: 10</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Setting Key:</span> DefaultExemptEntityCode  <span style="font-weight: bold;">Setting Value:</span> G</p>
  <h5>Registries to Define Default Fixed Fee Tax Codes:</h5>
  <p><span style="font-weight: bold;">Setting Key:</span> FixedFeeTaxableTaxCode   <span style="font-weight: bold;">Setting Value:</span>  <span style="font-style: italic;">Avalara </span>Tax Code</p>
  <p><span style="font-weight: bold;">Setting Key:</span> FixedFeeNonTaxableTaxCode  <span style="font-weight: bold;">Setting Value:</span> <span style="font-style: italic;">Avalara Tax Code</span></p>
  <p><span style="font-weight: bold;">Setting Key:</span> FixedFeeExemptTaxCode  <span style="font-weight: bold;">Setting Value:</span>  <span style="font-style: italic;">Avalara Tax Code</span></p>
  <p style="font-style: italic;">The above registry settings specify the appropriate default Avalara Tax Code to use for Fixed Fee Billing Items. <span style="font-weight: bold;">They may be trumped by the Alavara Tax Code in the Job Billing Item.</span></p>
  <h5>Registry and Setting for Overriding Fixed Fee Tax Codes by Job Billing Item:</h5>
  <p style="font-style: normal;">This enhancement supports the optional specification of Job Billing Item-specific Avalara Tax Codes If the following registry is enabled it is used to switch between the two methods of determining the appropriate Alalara Tax Code:</p>
  <p style="margin-left: 48px;">a) Fixed Fee Avalara Tax Codes referenced in the sys-avalara registry;</p>
  <p style="margin-left: 48px;">b) Avalara Tax Codes in the Job Billing Item User field defined in the registry below.</p>
  <p style="margin-left: 8px;">This information will be referenced in the Record Billing Adjustments function when the user pushes the Compute Taxes button.</p>
  <p style="margin-left: 8px;"><span style="font-weight: bold;">Id:</span> sys-avalara</p>
  <p style="margin-left: 8px;"><span style="font-weight: bold;">Setting Key:</span> FixedFeeTaxCodeUserField   <span style="font-weight: bold;">Setting Value:</span> <span style="font-style: italic;">integer from 1 to 5</span></p>
  <p style="margin-left: 8px;">The Setting Value specifies which Job Billing Item User field should contain the Avalara Tax Code for Fixed Fee Job Billing Items. If entered, it trumps all other Fixed Fee-based Tax Codes from the Avalara registry.</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Tip: Job Billing Item User Field Referenced by FixedFeeTaxCodeUserField</span>  <br/>
    It is strongly recommended that the Custom Fields functionality is used to relabel the applicable Job Billing Item User field as &quot;Avalara Tax Code: &quot;. The appropriate Custom Field Values should also be set to the appropriate 8 or 2 character code (as specified by Avalara).</p>
  <h3>Registry to Disable Use Tax Calculations</h3>
  <p>This option (highly recommended) disables calls to the Avalara external tax service in situations where Use Tax is being calculated.  When disabled, Use Tax computations are done with SAMPro and no external call is made.</p>
  <p><span style="font-weight: bold;">Id: </span>sys-ffv-global-settings</p>
  <p><span style="font-weight: bold;">Setting Key:</span> UseExternalTaxServiceForUseTax   <span style="font-weight: bold;">Setting Value:</span> false  (default is true)</p>
  <h3>Registry to Not Submit $0 (Zero Dollar) Invoices</h3>
  <p>This registry allows users to prevent unnecessary transactions for zero-dollar invoices. </p>
  <p><strong>Id:</strong> sys-avalara    </p>
  <p><strong>Setting Key: </strong>SkipZero$Invoices    <strong>Setting Value:</strong>  true</p>
  <h3>Other Record Configurations for the Avalara Web Service</h3>
  <p style="font-weight: bold;">User:</p>
  <p>A SAMPro Special User must be set up to manage the handshake between SAMPro and the Avalara Web Service Integration.  This User Id and Password must both be set to <span style="font-weight: bold;">taxservice</span>.</p>
  <p style="font-weight: bold;"><span style="font-weight: bold;"><span style="font-weight: bold;">Job Cost Category Records:</span></span></p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Avalara Tax Code:</span>  <br/>
    Service Invoice Job Cost Categories should have this field completed if the Avalara-defined default value should not be used.</p>
  <p style="font-weight: bold; margin-left: 48px;">Cost Category Group Id:<br/>
    <span style="font-weight: normal;">This field should be set to the Avalara Group for Job Cost Categories used with Avalara web.</span>
  </p>
  <p style="font-weight: bold; margin-left: 8px;">Cost Category Group Record</p>
  <p style="margin-left: 48px; font-weight: bold;">Cost Category Group Id:<br/>
    <span style="font-weight: normal;">A Job Cost Category Group should be created with the Id of Avalara.</span>
  </p>
  <p style="margin-left: 8px; font-weight: bold;">Job:</p>
  <p style="font-weight: bold; margin-left: 48px;">Sales Tax Group:<br/>
    <span style="font-weight: normal;">If this Group was created in SAMPro (not imported from Avalara), SAMPro&#39;s internal sales tax processing will be used to generate sales or use tax on invoices for this job. If this field is blank, it will be completed when the Job is invoiced for the first time using the Avalara Web Integration.</span>
  </p>
  <p style="margin-left: 48px;"><img alt="" border="0" src="assets/images/SetTaxGroup.bmp" style="border: none;"/>  If the Avalara Web Integration is enabled, clicking this button will make a call to Avalara to set the correct Sale Tax Group for invoicing this Job.</p>
  <p style="margin-left: 8px; font-weight: bold;">Client Site:</p>
  <p style="margin-left: 48px;"><img alt="" border="0" src="assets/images/ValidateAddress.bmp" style="border: none;"/> If the Avalara Web Integration is enabled, clicking this button will make a call to Avalara to validate that Work Site Address is correctly configured so that the correct Sales Tax Authority Group can be determined when invoicing.</p>
  <h3>Other Files</h3>
  <p style="margin-left: 48px; font-style: italic;">The following files compatible with the v.exe SAMPro image must reside in the same directory:</p>
  <p style="margin-left: 48px; font-style: italic;">vdevw.exe.manifest</p>
  <p style="margin-left: 48px; font-style: italic;">v.exe.manifest</p>
  <p style="margin-left: 48px; font-style: italic;">SamproNetFramework.dll</p>
  <p style="margin-left: 48px; font-style: italic;">Newtonsoft.Json.dll</p>
  <p style="margin-left: 48px; font-style: italic;">Data-Basics.Avalara.Net (Folder and contents)</p>
  <h3>Starter Functions</h3>
  <p style="margin-left: 8px; font-weight: bold;">Start Validate Avalara Configuration</p>
  <p style="margin-left: 8px;">This function allows validation without having the UseExternalTaxService setting turned on.  This allows authentication of the configuration (sys-avalara) prior to enabling live integration.<span style="font-weight: bold;"> </span></p>

</body></html>