<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head>

  <script type="text/javascript" language="JavaScript">
    //<![CDATA[
    function reDo() {
      if (innerWidth != origWidth || innerHeight != origHeight)
        location.reload();
    }
    if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
      origWidth = innerWidth;
      origHeight = innerHeight;
      onresize = reDo;
    }
    onerror = null;
  //]]>
  </script>
  <style type="text/css">/*<![CDATA[*/

    < !-- div.WebHelpPopupMenu {
      position: absolute;
      left: 0px;
      top: 0px;
      z-index: 4;
      visibility: hidden;
    }

    p.WebHelpNavBar {
      text-align: right;
    }

    -->
  
/*]]>*/</style>

  <script type="text/javascript">//<![CDATA[

    gRootRelPath = ".";
    gCommonRootRelPath = ".";
    gTopicId = "2.18.4.0_1";
  
//]]></script>

  <script type="text/javascript" src="./template/scripts/rh.min.js"></script>
  <script type="text/javascript" src="./template/scripts/common.min.js"></script>
  <script type="text/javascript" src="./template/scripts/topic.min.js"></script>
  <script type="text/javascript" src="./template/scripts/topicwidgets.min.js"></script>
<script type="text/javascript" src="./whxdata/projectsettings.js"></script>
  <link rel="stylesheet" type="text/css" href="./template/styles/topic.min.css"/>
  <link rel="stylesheet" type="text/css" href="./template/single_page/topicheader.css"/>
  <meta name="topic-status" content="Draft"/>

  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <meta name="MS-HKWD" content="carbon copy"/>
  <meta name="MS-HKWD" content="sys-email"/>
  <meta name="MS-HKWD" content="outlook"/>
  <meta name="MS-HKWD" content="redirect"/>
  <meta name="MS-HKWD" content="email"/>
  <meta name="MS-HKWD" content="registry"/>
  <meta name="topic-status" content="Sent for Review"/>
  <meta name="generator" content="Adobe RoboHelp 2020"/>
  <title>Registry System Email (sys-email)</title>
  <link rel="StyleSheet" href="assets/css/sampro.css" type="text/css"/>
  <meta name="rh-index-keywords" content="carbon copy,sys-email,outlook,redirect,email,registry"/>
<meta name="brsnext" value="Registry_Printer_Dialog_Boxes.htm"/><meta name="brsprev" value="Registry_Return_Address.htm"/></head>

<body>
  <div class="topic-header rh-hide" id="rh-topic-header">
    <div class="logo">
    </div>
    <div class="nav">
      <div class="title" title="Registry System Email (sys-email)">
        <span>Registry System Email (sys-email)</span>
      </div>
      <div class="gotohome" title="Click here to see this page in full context">
        <a href="#" onclick="rh._.goToFullLayout()">Click here to see this page in full context</a>
      </div>
    </div>
  </div>
  <div class="topic-header-shadow rh-hide" id="rh-topic-header-shadow"></div>



  <h1>Registry System Email (sys-email)</h1>
  <h2>Purpose:</h2>
  <p>This registry entry identifies the address of your firm&#39;s e-mail server, and may be used to specify test settings such as cc’ing and redirects. It is required for implementation of Escalation Manager and Report Anywhere.</p>
  <p class="Body_Text_Indent" style="border-top: 0.50pt solid #000000; border-bottom: 0.50pt solid #000000; 
	 border-left: 0.50pt solid #000000; border-right: 0.50pt solid #000000;">
    <font color="#FF0000" style="font-weight: bold;">Testing Your Registry Entries</font><br/>
    <font style="font-weight: bold; font-style: italic;">The system does not verify the validity of registry entries.</font> Be sure to <font style="font-weight: bold;">test</font> your registry entries after completing them to verify that they are functioning correctly.
  </p>
  <p class="Body_Text_Indent" style="border-top: 0.50pt solid #000000; border-bottom: 0.50pt solid #000000; 
	 border-left: 0.50pt solid #000000; border-right: 0.50pt solid #000000;"><span style="font-weight: bold;">
      <font color="#FF0000" style="font-style: italic;">Setting</font>
      <font color="#FF0000" style="font-style: italic;">Value Notes:</font>
    </span><br/>
    The Setting Value is case-sensitive: be sure that you enter the value <font style="text-decoration: underline; ">exactly</font> as specified in the documentation. If the documentation specifies a value of true, do NOT enter True or TRUE.<br/>
    The equal sign = is a reserved character in the Setting Value.  It should <span style="font-weight: bold;">NEVER</span> be used in the Setting Value field unless you are specifically instructed to do so for particular registry setting.<span style="font-weight: bold;"> </span></p>
  <h2>Usage:</h2>
  <p>SAMPro’s SMTP mechanism includes an Authentication mechanism for mail servers providing LOGIN authentication.</p>
  <p>Enhanced MS Outlook support is also offered, and may be implemented with this registry entry. If this is implemented, <font style="font-weight: bold;">all</font> your SAMPro users <font style="font-weight: bold;">must</font> be running MS Outlook.</p>
  <p style="margin-left: 48px;">
    <font style="font-weight: bold;">Note: Managing Emailed PDF’s</font><br/>
    When e-mailing .PDF reports generated from SAM Pro, a copy of the report will be retained in the xmlToPdf_Sent folder located in the directory containing your SAM Pro executable (v.exe). You may wish to periodically clear or archive these files.
  </p>
  <h2>Important Fields:</h2>
  <p class="Tip_Note_Heading" style="margin-top: 4.00pt;">Id:</p>
  <p>The Id of the Registry Entry must conform to one of the following formats:</p>
  <p style="margin-left: 36.00pt;">
    <font style="font-weight: bold;">sys-email</font>
    <font style="font-weight: bold; font-style: italic;">-branchid-userid</font> (or <font style="font-weight: bold;">sys-email</font>
    <font style="font-weight: bold; 
															 font-style: italic;">--userid</font> if branches are not implemented)<br/>
    <font style="font-weight: bold;">sys-email-</font>
    <font style="font-weight: bold; 
														 font-style: italic;">branchid</font><br/>
    <font style="font-weight: bold;">sys-email-</font>
    <font style="font-weight: bold; 
														 font-style: italic;">securityid</font>
  </p>
  <p style="margin-left: 36.00pt;">
    <font style="font-weight: bold; 
														 font-style: italic;"><span style="font-style:italic;">sys-email-company: </span><span style="font-style:italic;">companyid </span><span style="font-style:italic;"></span></font><br/>
    <span style="font-weight: bold;">sys-email</span>
  </p>
  <p style="margin-left: 36.00pt;">The first format enables you to specify e-mail parameters by branch id and/or user. A branch must be specified if a user belongs to a branch. If branches are not implement, two dashes (not separated by a space) must precede the user id.</p>
  <p style="margin-left: 36.00pt;">The second format enables you to the e-mail server by security id.</p>
  <p style="margin-left: 36.00pt;">The third format would apply to all users unless another registry entry was created for their security or branch/user id.</p>
  <p style="margin-left: 36.00pt;">The fourth format creates email settings on a per-company basis using this company. </p>
  <h3>SMTP Server Configuration</h3>
  <p>
    <font style="font-weight: bold;">Setting Key:</font> serversmtp <font style="font-weight: bold;"> Setting Value:</font>
    <font style="font-style: italic;">address</font>
  </p>
  <p style="margin-left: 8px;">where <font style="font-weight: bold; font-style: italic;">address</font> is replaced by the address of your e-mail (smtp) server. Typically, this will be an internal IP address.</p>
  <p>
    <font style="font-weight: bold;">Setting Key:</font> usernamesmtp <font style="font-weight: bold;"> Setting Value:</font>
    <font style="font-style: italic;">name</font><br/>
    <font style="font-weight: bold;">Setting Key:</font> passwordsmtp <font style="font-weight: bold;"> Setting Value:</font>
    <font style="font-style: italic;">password</font>
  </p>
  <p style="margin-left: 8px;">SAM Pro’s SMTP mechanism includes an Authentication mechanism for mail servers providing LOGIN authentication (Microsoft Exchange Server and MDaemon, for example).</p>
  <p style="margin-left: 36.00pt;">
    <font style="font-weight: bold;">Authentication and Sending PDF’s as E-mail:</font><br/>
    If these SMTP options are specified, they must be configured properly for SAMPro to email PDF’s.
  </p>
  <h3>Alternate Ports</h3>
  <p>This release (used in conjunction with the xmlToPdf.jar file dated 11/8/2011) supports alternate email ports for emails with .pdf attachments (controlled by the xmlToPdf.jar file) as well as emails without pdf attachments (managed by SAM Pro). The following two additional options in sys-email are required to support this functionality:</p>
  <p>
    <font style="font-weight: bold;">Setting Key:</font> portsmtp <font style="font-weight: bold;">Setting Value:</font>port# (controls emails without pdf’s)<br/>
    <font style="font-weight: bold;">Setting Key:</font> smtpPort <font style="font-weight: bold;">Setting Value:</font>
    <font style="font-style: italic;">port#</font>
    <font style="font-style: italic;">(controls emails with pdf’s)</font>
  </p>
  <p>
    <font style="font-weight: bold; font-style: italic;">Note that if</font>
    <font style="font-weight: bold; font-style: italic;">the above options are omitted,</font>
    <font style="font-weight: bold; font-style: italic;">port 25 will be the default.</font>
  </p>
  <h3>Secure Servers</h3>
  <p>SAMPro supports secure (SSL) email servers. To implement, the following additional registries are required:</p>
  <p>
    <font style="font-weight: bold;">Setting Key:</font> useSSL  <font style="font-weight: bold;">Setting Value:</font> true
  </p>
  <p>
    <font style="font-weight: bold;">Setting Key:</font> MailerMethod <font style="font-weight: bold;">Setting Value:</font> Java <font style="font-style: italic;">(required to send non-pdf emails securely)</font>
  </p>
  <p style="margin-left: 36.00pt;">Example: Use Port 465, Secure Server</p>
  <p style="margin-left: 36.00pt;">Setting Key: portsmtp Setting Value: 465</p>
  <p style="margin-left: 36.00pt;">Setting Key: smtpPort Setting Value:465</p>
  <p style="margin-left: 36.00pt;">Setting Key: useSSL  Setting Value: true</p>
  <p style="margin-left: 36.00pt;">Setting Key: MailerMethod Setting Value: Java</p>
  <p style="margin-left: 36.00pt;">Note: the applicable PasswordSMTP, UserNameSMTP, and serversmtp options must also be set.</p>
  <h3 style="margin-left: 8px;">Regarding SMTP Email Security</h3>
  <p class="MsoNormal" style="margin-left: 8px;">The built-in SAMPro emailer does not support Email Security. In order to utilize, you must use the Java Emailer (XMLtoPDF), enabled via MailerMethod=Java</p>
  <p class="MsoNormal" style="margin-left: 8px;">There are 2 types of security, SSL and TLS. SSL is older/obsolete and has been replaced by TLS. It is best to use TLS when available.</p>
  <p class="MsoNormal" style="margin-left: 8px;">By default, XMLtoPDF will attempt to use TLS initially, and will fall back to Plain (not secure) if not supported by the SMTP server and/or TCP/IP port.</p>
  <p class="MsoNormal" style="margin-left: 8px;">If it is needed to utilize the older/obsolete SSL security method, the option UseSSL=true can be used.</p>
  <p class="MsoNormal" style="margin-left: 8px;">Although TCP/IP ports for SMTP servers are not directly related to SSL/TLS, these typical SMTP port configurations will help for set up. Keep in mind your SMTP email provider may offer other configurations:</p>
  <p class="MsoNormal" style="margin-left: 48px;">25 – Commonly Plain (unsecure), but can sometimes support SSL &amp; TLS</p>
  <p class="MsoNormal" style="margin-left: 48px;">465 – Commonly, but not limited to SSL</p>
  <p class="MsoNormal" style="margin-left: 48px;">587 – Commonly, but not limited to TLS</p>
  <p class="MsoNormal" style="margin-left: 8px;">Today’s standard is to use port 587 with TLS.</p>
  <p class="MsoNormal" style="margin-left: 48px;">Example sys-email registries to use this:</p>
  <p class="MsoNormal" style="margin-left: 48px;">Setting Key: MailerMethod   Setting Value: Java</p>
  <p class="MsoNormal" style="margin-left: 48px;">Setting Key: PortSMTP  Setting Value: 587</p>
  <p class="MsoNormal" style="margin-left: 48px;">Setting Key: SMTPport  Setting Value: 587</p>
  <h3>Default Email Sender Registry</h3>
  <p style="margin-left: 8px;">If a From address cannot be determined, an Email cannot be sent. Especially in the case of emailing as a PDF, the XML will contain a blank emailFrom tag and the email will fail silently in the xmlToPdf_Failed folder.</p>
  <p><span style="font-weight: bold;">Setting Key:</span> DefaultEmailSender  <span style="font-weight: bold;">Setting Value:</span> <span style="font-style: italic;">validemailaddress</span></p>
  <p>If a &#39;From&#39; email address cannot be determined from the User&#39;s Contact Record (for reports) or the Notification Category (for Scheduled Events), this email address will be used instead.</p>
  <p>Reports:</p>
  <p style="margin-left: 48px;">1. When clicking the email button on a report (if UseOutlook=false), the Sender field is now required on the SAMPro Email screen. If the Email address is not completed in the User&#39;s Contact record, the Sender field will default from the sys-mail registry&#39;s DefaultEmailSender option.</p>
  <p style="margin-left: 48px;">2. The Email From field in the Schedule Report screen is now required. If the Email address is not completed in the User&#39;s Contact record, the Email From field will default from the sys-mail registry&#39;s DefaultEmailSender option.</p>
  <p style="margin-left: 8px;">Scheduled Events: If the email-from is not set by the Scheduled Event Manager, the default email sender from  the sys-email registry will be used.</p>
  <h3>Enhanced MS Outlook Support</h3>
  <p class="Tip_Note_Heading" style="margin-top: 4.00pt;">Setting Key: <font style="font-weight: normal;">UseOutlook</font>  Setting Value: <font style="font-weight: normal;">true</font>
  </p>
  <p>If this entry is present, processing of the outgoing e-mail is passed on to Outlook with the to-address, subject, message and attachments defaulted when applicable. Older versions of Outlook may not be supported.</p>
  <p>In Versions 9.0-9.1, UserOutlook is supported with Outlook 365/Outlook 2016. Other Outlook versions may or may not work. The appropriate XmlToPdf.jar file must also be in use. As of January 2019, the following versions (renamed as XmlToPdf.jar) are recommended:</p>
  <p style="margin-left: 48px;">XmlToPdf[2019-01-16] Java8-11].jar file which supports Java 8-11 but not Java 7</p>
  <p style="margin-left: 48px;">XmlToPdf[2017-12-27].jar to XmlToPdf.jar (Installations with Java 7 and Java 8 users)</p>
  <p>NOTE:  this is intended to be used with supported versions of Outlook.  Outlook Express doesn&#39;t support the command-line attachments.  Other email clients may or may not work.</p>
  <p style="font-weight: bold;">If UseOutlook is enabled, the CopyAll and AutoPopulateCCAddress should NOT be enabled.</p>
  <p style="margin-left: 36.00pt;">
    <font style="font-weight: bold;">Start AP Payment Approved</font>
    <font style="font-weight: bold;">:</font>
    <font style="font-weight: bold;">and Quotemaster Vendor Approval</font><br/>
    If Outlook is enabled, the regular SAM Pro email form will appear when the Dispute / Vendor approval button is clicked.
  </p>
  <p>When Outlook is implemented, the following will occur when you click the E-mail button on a SAMPro report:</p>
  <p style="margin-left: 36.00pt;">The Outlook e-mail form (not SAMPro’s) will open.</p>
  <p style="margin-left: 36.00pt;">The report that you generated will be attached in its default PDF format (or as set in the registry).</p>
  <p style="margin-left: 36.00pt;">The From: line will be completed with the e-mail address from your Outlook profile.</p>
  <p style="margin-left: 36.00pt;">The To: line will be completed with the default values if this is supported for the report.</p>
  <p style="margin-left: 36.00pt;">The Subject line will be defaulted according to the report.</p>
  <p style="margin-left: 36.00pt;">The report will be attached.</p>
  <p>When the Outlook form is up, you may add additional recipients from your Outlook address box, enter a text message, and include additional attachments. When you click Send, a copy of the e-mail will remain in your Sent box if you have implemented this feature in Outlook, as well as in the xmlToPdf_Sent folder in directory containing your SAM Pro executable.</p>
  <p style="margin-left: 36.00pt;">
    <font style="font-weight: bold;">Important Note on dbreportfiles Registry Entry and Subfolders</font>
  </p>
  <p style="margin-left: 36.00pt;">If UseOutlook is enabled, the directory specified by the dbreportfiles registry entry is expected to contain subfolders xmlToPdf_Sent, xmlToPdf_Failed and xmlToPdf_Retry.  If they don&#39;t exist in this directory, they must currently be created manually. See <a href="Registry_Entry_for_Report_Anywhere_File_Path.htm">
      <font color="#000000">Registry Entry for Report Anywhere File Path</font>
    </a> for details.</p>
  <h3><strong>Allow Email &quot;To&quot; features to work when using Outlook registry setting</strong></h3>
  <p>When the below registry is set to true, the Email Address &quot;TO:&quot; populates with the Default Client Site&#39;s Email Address into Outlook. <br/>
    <strong>Id:</strong>  &#39;sys-email’<br/>
    <strong>Setting Key:</strong> UseOutlook        <strong>Setting Value:</strong> true
  </p>
  <h3>Java Mailer</h3>
  <p class="Tip_Note_Heading" style="margin-top: 4.00pt;">Setting Key: <font style="font-weight: normal;">MailerMethod</font> Setting Value: <font style="font-weight: normal;">Java</font>
  </p>
  <p>This registry option results in Java code sending all e-mail that initiates from within the system, not SAMPro. Note that Java is used when sending e-mail with PDF attachments. This option may be utilized if difficulties with e-mail are being experienced. Do not implement this registry entry until you have discussed it with your support representative.</p>
  <h3>Report Attachment Defaults</h3>
  <p>
    <font style="font-weight: bold;">Setting Key:</font> EmailReportAsType <font style="font-weight: bold;">Setting Value:</font>
    <font style="font-style: italic;">pdf or text</font>     (pick one option)
  </p>
  <p>This entry applies to pushing the Email button on the side toolbar when displaying a report on screen. It sets the default attachment type of the report. The attachment type defaults to pdf if this option is not specified. The options of html and csv are deprecated for this global setting.</p>
  <h3>Comparison Against Database</h3>
  <p>This option enables you to prevent copies of your database (which may be running for training or testing purposes) from interfering with &quot;live&quot; operations. Implementing this option would help avoid inadvertently emailing and pages or overwriting your real invoices while running a copy of your data to train new personnel.</p>
  <p>You may specify either or both:</p>
  <p class="Tip_Note_Heading" style="margin-top: 4.00pt;">Setting Key: <font style="font-weight: normal;">eng</font>  Setting Value: <font style="font-style: italic; font-weight: normal;">enginename</font>
  </p>
  <p>where <font style="font-style: italic;">enginename</font> is replaced by the engine name that your live data runs under.</p>
  <p class="Tip_Note_Heading" style="margin-top: 4.00pt;">Setting Key: <font style="font-weight: normal;">dbn</font>  Setting Value: <font style="font-style: italic; font-weight: normal;">databasename</font>
  </p>
  <p>where <font style="font-style: italic;">databasename</font> is replaced by the name of your live database. Do not include the .db extension in the databasename (mydata rather than mydata.db).</p>
  <h3>Copy All</h3>
  <p class="Tip_Note_Heading" style="margin-top: 4.00pt;">Setting Key: <font style="font-weight: normal;">CopyAll</font>  Setting Value: <font style="font-style: italic; font-weight: normal;">emailaddress</font>
  </p>
  <p>This option enables you to send an extra copy of all e-mail generated out of SAM Pro to a specific address or addresses (separated by commas) where <font style="font-style: italic;">emailaddress</font> is replaced by the address you wish to copy all emails to. This option would typically be implemented for testing purposes for a limited time frame.</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Tip - Service Invoice Billing</span><br/>
    Creating a user-specific sys-email registry allows billers to send themselves a copy of their auto-mailed Service Invoices. This registry would use the format <font style="font-weight: bold;">sys-email</font>
    <font style="font-weight: bold; 
	 font-style: italic;">-branchid-userid</font> (or <font style="font-weight: bold;">sys-email</font>
    <font style="font-weight: bold; font-style: italic;">--userid</font> if branches are not implemented).
  </p>
  <h3>CC Default for Manual Emails</h3>
  <p>
    <font style="font-weight: bold;">Setting Key:</font>
    <font style="font-style: italic;">AutoPopulateCCAddress</font>
    <font style="font-weight: bold;">Setting Value:</font> true
  </p>
  <p>If this registry option is implemented, the system will use the currently logged in user&#39;s email address (from the contact reference in the user record) to Auto-populate the CC email address when launching the SAMPro Email formatting form. This would apply anywhere that the USER initiates the open the MANUAL email form...i.e. dispatch board, previewed report, etc.</p>
  <p>Note: Some Manual Email Forms (like on previewed reports) do not have a CC line. In these cases, the CC address will be added to the Send to address when the email is sent.</p>
  <h3>Provide Image/Logo in Emails</h3>
  <p>This registry allows users to add company headers and footers to auto-generated emails. This makes auto-generated emails look professional and provides assurance for the receiver that they do come from the company.</p>
  <p><strong></strong></p>
  <p><strong>Id: </strong>sys-report/viewer-functionId</p>
  <p><strong>Setting Key:</strong> EmailHeaderImage            <strong>Setting Value:</strong> (path to the image)</p>
  <p><strong>Example:</strong> <em>https://www.databasics.com/images/email/header.png</em></p>
  <p><strong>Setting Key:</strong> EmailFooterImage              <strong>Setting Value:</strong> (path to the image)</p>
  <p><strong>Example:</strong> <em>https://www.databasics.com/images/email/footer.png</em></p>
  <p><strong>Note: The path to the image must be accessible via the web, otherwise, the image will not appear in the email for the recipient.</strong></p>
  <p><strong></strong></p>
  <h3>Scheduled Event Escalation Email Image/Logo</h3>
  <p><strong>Id:</strong> sys-emailHeaderImage-escalation</p>
  <p><strong>Setting Key: </strong>Escalation Profile Id    <strong>Setting Value:</strong> (path to the image)</p>
  <p><strong>Ex:</strong> <em>https://www.databasics.com/images/email/header.png</em></p>
  <p><strong>Id:</strong> sys-emailFooterImage-escalation</p>
  <p><strong>Setting Key:</strong> Escalation Profile Id       <strong>Setting Value:</strong> (path to the image)</p>
  <p><strong>Ex:<em> </em></strong><em>https://www.databasics.com/images/email/footer.png</em></p>
  <p><strong>Note: The path to the image must be accessible via the web, otherwise, the image will not appear in the email for the recipient.</strong></p>
  <h3>Redirect E-mail</h3>
  <p class="Tip_Note_Heading" style="margin-top: 4.00pt;">Setting Key: <font style="font-weight: normal;">RedirectAll</font> Setting Value: <font style="font-style: italic; font-weight: normal;">emailaddress</font>
  </p>
  <p>This option enables you to redirect all e-mail generated out of SAM Pro to a specific address or addresses (separated by commas). This option would typically be implemented to avoid sending out spurious e-mails when you are running a test system.</p>
  <p style="font-weight: bold;">Note - Problem Analysis if E-mails are Not Sending:</p>
  <p><a class="dropspot" data-rhwidget="DropSpot" data-target="POPUP461864023" href="#"><span data-open-text="true" data-skip-index="true">Click for troubleshooting details.</span><span data-close-text="true">Click for troubleshooting details.</span></a></p>
  <div data-targetname="POPUP461864023">
    <p>The Smalltalk email routines first try to log onto the mail server
      using the EHLO command. This is an extended &#39;hello&#39; command. The response
      to EHLO identifies what kind of authentication is accepted by the
      server. In this case it indicates that LOGIN authentication is accepted.</p>
    <p>The email client proceeds with LOGIN authentication which is failing.
      It then tries the basic, non-authenticated HELO log in which succeeds
      and the email is successfully sent. The XmlToPdf routine follows this
      same process except that it quits when the LOGIN authentication fails.</p>
    <p>The real problem probably lies with the authentication username
      and password passed to these routines which the server may not like.</p>
    <p>Solution:</p>
    <p style="margin-left: 8px;">The recommended implementation is to determine
      the proper credentials for logging into the customer&#39;s email server
      and to update the Sampro registry accordingly. Alternately, the administrator
      may remove the SMTP username and password values from the Registry
      sys-email, or set them to blank. Note that in both Sampro and xmlToPdf,
      if there are no credentials (or blank credentials) in the Sampro registry,
      authentication is not even attempted.</p>
    <p>
      <font style="font-weight: bold;">LOGIN authentication requires the
        knowledge of a valid username/password pair.</font> These may be supplied
      in the option dictionary passed to the ‘SMTP&gt;&gt;sendMail:’ command.
      The dictionary keys for these parameters are ‘#Username’ and ‘#Password’.
      If these parameters are missing from the option dictionary, (as is
      normally the case) an attempt is made to retrieve them from the Registry
      from this registry entry. If LOGIN authentication fails, a non-authenticated
      session (like the one implemented in previous releases) will be attempted.
    </p>
  </div>
  <h3>Log SMTP Conversations</h3>
  <p>A registry entry may be used to turn on the logging of SMTP ‘conversions’ to a log file. To turn on logging for support purposes, add the following entry:<br/>
    <br/>
    <font style="font-weight: bold;">Setting Key:</font> smtplogpath <font style="font-weight: bold;">Setting Value:</font>
    <font style="font-style: italic;">C:\someDirectory\someFileName.log</font>
  </p>
  <h3>
    <font style="font-style: italic;">O</font>ptional POP3 Server Configuration
  </h3>
  <p>
    <font style="font-weight: bold;">Setting Key:</font> pop3server <font style="font-weight: bold;">Setting Value:</font>
    <font style="font-style: italic;">address</font>
  </p>
  <p style="margin-left: 36.00pt;">where <font style="font-weight: bold; 
											 font-style: italic;">address</font> is replaced by the address of your pop3 server (to retrieve e-mail). Typically, this will be an internal IP address.</p>
  <p class="Tip_Note_Heading" style="margin-top: 4.00pt;">Setting Key: <font style="font-weight: normal;">pop3user</font> Setting Value: <font style="font-style: italic; font-weight: normal;">pop3username</font>
  </p>
  <p style="margin-left: 36.00pt;">where <font style="font-weight: bold; 
											 font-style: italic;">pop3username</font> is replaced by the user&#39;s pop3 user id (for retrieving e-mail).</p>
  <p class="Tip_Note_Heading" style="margin-top: 4.00pt;">Setting Key: <font style="font-weight: normal;">pop3pw</font> Setting Value: <font style="font-style: italic; 
	 font-weight: normal;">pop3password</font>
  </p>
  <p style="margin-left: 36.00pt;">where <font style="font-weight: bold; 
											 font-style: italic;">pop3password</font> is replaced by the user&#39;s password on the pop3 server (for retrieving e-mail).</p>
  <p>
    <font style="font-weight: bold;">Setting Key:</font> pop3timeout <font style="font-weight: bold;">Setting Value:</font>
    <font style="font-style: italic;">timems</font>
  </p>
  <p style="margin-left: 36.00pt;">where <font style="font-weight: bold; 
											 font-style: italic;">timems</font> is replaced by the time (in milliseconds) between when a request is sent and an error message is returned if timeout or other problem occurs.</p>
  <p>
    <font style="font-weight: bold;">Setting Key:</font> pop3secondswait <font style="font-weight: bold;">Setting Value:</font>
    <font style="font-style: italic;">checkagain</font>
  </p>
  <p style="margin-left: 36.00pt;">where <font style="font-weight: bold; 
											 font-style: italic;">checkagain</font> is replaced by the time (in seconds) that elapses before the inbox is checked again.</p>
  <h3>Note: Alarm Server Entries</h3>
  <p>If you will be running Alarm Server on your system (to receive alarms into the SAM Pro system), you must include the following sys-email registry entry. Note that you must have a mailbox named dispatcher with the password dispatcher set up on your pop3 server to receive alarms: this is the mailbox that SAM Pro will check. Note that the <font style="font-weight: bold;">terms</font> registry entry must also be completed.</p>
  <p style="margin-left: 36.00pt;">
    <font style="font-weight: bold;">Id</font>
    <font style="font-weight: bold;">:</font>
    <font style="font-weight: bold;">sys-email</font>
  </p>
  <p style="margin-left: 36.00pt;">
    <font style="font-weight: bold;">Setting Key</font>: pop3server <font style="font-weight: bold;"> Setting Value:</font>
    <font style="font-style: italic;">address</font><br/>
    <font style="font-weight: bold;">Setting Key</font>: pop3user <font style="font-weight: bold;"> Setting Value:</font> dispatcher<br/>
    <font style="font-weight: bold;">Setting Key:</font> pop3pw <font style="font-weight: bold;"> Setting Value:</font> dispatcher<br/>
    <font style="font-weight: bold;">Setting Key:</font> pop3secondswait <font style="font-weight: bold;"> Setting Value:</font> 60<br/>
    <font style="font-weight: bold;">Setting Key:</font> pop3timeout <font style="font-weight: bold;"> Setting Value:</font> 5000
  </p>
  <h3> </h3>
  <p><strong></strong></p>
  <script type="text/javascript" language="JavaScript1.2">
    //<![CDATA[
    if (typeof(TextPopupInit) != 'function') TextPopupInit = new Function();
    TextPopupInit('a1', 'POPUP461864023');
    //]]>
  </script>

</body></html>