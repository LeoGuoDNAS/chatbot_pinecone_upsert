<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="date" content="05 11, 2020" />
<meta name="author" content="KMcKinley" />
<meta name="creator" content="" />
<meta name="keywords" content="" />
<meta name="producer" content="Microsoft: Print To PDF" />
<meta name="subject" content="" />
<meta name="generator" content="Adobe RoboHelp 2017" />
<title>SAMPro Email Processor</title>
<link rel="StyleSheet" href="sampro.css" type="text/css" />
<link rel="StyleSheet" href="sampro.css" type="text/css" />
<script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
        origWidth = innerWidth;
        origHeight = innerHeight;
        onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
/*<![CDATA[*/
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
-->
/*]]>*/
</style>

<script type="text/javascript" language="javascript1.2" src="whmsg.js" charset="utf-8">
</script>
<script type="text/javascript" language="javascript" src="whver.js" charset="utf-8">
</script>
<script type="text/javascript" language="javascript1.2" src="whutils.js" charset="utf-8">
</script>
<script type="text/javascript" language="javascript1.2" src="whproxy.js" charset="utf-8">
</script>
<script type="text/javascript" language="javascript1.2" src="whlang.js" charset="utf-8">
</script>
<script type="text/javascript" language="javascript1.2" src="whtopic.js" charset="utf-8">
</script>
</head>
<body>
<script type="text/javascript" language="javascript1.2">
//<![CDATA[
<!--
if (window.gbWhTopic)
{
        var strUrl = document.location.href;
        var bc = 0;
        var n = strUrl.toLowerCase().indexOf("bc-");
        if(n != -1)
        {
                document.location.replace(strUrl.substring(0, n));
                bc = strUrl.substring(n+3);
        }

        if (window.addTocInfo)
        {
        addTocInfo("SAMPro Help\nCommon Records and Functions\nEmail Processor Customer Notes");
addButton("show",BTN_TEXT,"Show","","","","",0,0,"","","");

        }
        if (window.writeBtnStyle)
                writeBtnStyle();

        if (window.writeIntopicBar)
                writeIntopicBar(1);

        
        document.write("<p style=\"text-align:right\"> ");
AddMasterBreadcrumbs("sampro.htm", "", "&gt;", "Home", "Contents.htm");
document.write("<a href=\"Logging_On.htm\">SAMPro Help<\/a> &gt; <a href=\"Book_Viewer.htm\">Common Records and Functions<\/a> &gt; Email Processor Customer Notes<\/p>");

}
else
        if (window.gbIE4)
                document.location.reload();

onLoadHandler = function()
{
  if (window.setRelStartPage)
        {
        setTimeout("setRelStartPage('sampro.htm');", 1)

    setTimeout("UpdateBreadCrumbsMarker();", 1);
        }
}

if (window.addEventListener){  
        window.addEventListener('load', onLoadHandler, false);   
} else if (window.attachEvent){  
        window.attachEvent('onload', onLoadHandler);  
}

function onSetStartPage()
{
  autoSync(1);
  sendSyncInfo();
  sendAveInfoOut();
}
//-->
//]]>
</script><script type="text/javascript" src="./ehlpdhtm.js" language="JavaScript1.2">
</script>
<h1><span class="PdfCharStyle0">Email Processor - Customer Notes</span></h1>
<h2>Purpose:</h2>
<p class="PdfParaStyle03">Allows users to email information to generic, specified email address and have the system automatically create an Attached Document and a Note record that is associated to specific record(s) on various database tables in SAMPro as outlined below.</p>
<h2>Setup:</h2>
<p class="PdfParaStyle03">See <a href="SAMPro_Email_Processor_Customer_Instructions.htm">Email Processor Support</a> for setup procedures used by your support rep to install this functionality.</p>
<h2>Usage:</h2>
<p class="PdfParaStyle03"><span class="PdfCharStyle3">The subject of the email will display as the description of the attachment, as well as specify which record to attach to. The email will save as a PDF, and any attachments</span> <span class="PdfCharStyle4">on the email</span> <span class="PdfCharStyle3">will list as a separate attachment on the record document viewer. The summary of the simplified note that is created will also derive from the email subject.</span></p>
<p class="PdfParaStyle03"><span class="PdfCharStyle3">The following subject tokens, when in the subject of the email will attach the document directly to the table, and record specified by the token.</span></p>
<p class="PdfParaStyle03"><span class="PdfCharStyle3">Syntax: [</span><span class="PdfCharStyle3" style="background-color: #ffff80;">Token</span><span class="PdfCharStyle3" style="background-color: #00ff00;">(Value)</span> <span class="PdfCharStyle3"></span><span class="PdfCharStyle3" style="background-color: #ff00ff;">Keyword(xxx)</span><span class="PdfCharStyle3">]</span> <span class="PdfCharStyle3" style="background-color: #00ffff;">Subject</span> <span class="PdfCharStyle4">(Case insensitive)</span></p>
<p class="PdfParaStyle03">&#160;</p>
<table style="border-collapse: separate; border-collapse: separate;" width="100%" border="1">
<col width="175" />
<col width="302" />
<col />
<tr style="height: 139px;">
<td rowspan="2" style="vertical-align: top; border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-top-width: 0px;" bgcolor="#FFFFFF">
<p class="reference-line">Job - Job Id<br />
<span class="PdfCharStyle4">Site - Client Site Id<br />
Client - Client Id</span><br />
<span class="PdfCharStyle4">Vendor - Vendor Id</span><br />
<span class="PdfCharStyle4">WO - Work Order Id<br />
Quote - Quote Id<br />
PO - Purchase Order Id<br />
Tech- &#160;Technician Id</span> <span class="PdfCharStyle4">&#160;</span></p>
</td>
<td style="vertical-align: top; border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-top-width: 0px;" bgcolor="#FFFFFF">
<p class="reference-line">Token: [<span style="background-color: #ffff80;">JOB</span><span style="background-color: #00ff00;">(jb_id)</span>]<br />
Token: [SITE(clntste_id)]<br />
Token: [CLIENT(clnt_id)]<br />
Token: [VENDOR(vndr_id)]<br />
Token: [WO(wrkordr_id)]<br />
Token: [QUOTE(qte_id)]<br />
Token: [PO(prchseordr_id)]<br />
Token: [TECH(tchncn_id)]</p>
</td>
<td style="vertical-align: top; border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-top-width: 0px;" bgcolor="#FFFFFF">
<p class="reference-line"><span class="PdfCharStyle3">Example: [Job(S-30220)]</span> <span class="PdfCharStyle4"><br /></span> <span class="PdfCharStyle3">Example: [site(KMART-01)]</span> <span class="PdfCharStyle4"><br /></span> <span class="PdfCharStyle3">Example: [client(KMART)]</span> <span class="PdfCharStyle4"><br /></span> <span class="PdfCharStyle3">Example: [vendor(GRANGER)]<br />
Example: [WO(120010)]</span> <span class="PdfCharStyle4"><br /></span> <span class="PdfCharStyle3">Example: [Quote(55102)]<br />
Example: [PO(35001)]</span> <span class="PdfCharStyle4"><br /></span> <span class="PdfCharStyle3">Example: [Tech(SAMMY)]</span> <span class="PdfCharStyle4">&#160;</span></p>
</td>
</tr>
</table>
<p class="PdfParaStyle07">This next set of keywords are used to set various values in the Note and Document viewers during processing. The default Document “Category” is note, so keyword: Doctype is only entered if a different document Category is desired.</p>
<ul style="list-style: disc;">
<li class="p-PdfParaStyle08" style="margin-top: 11px; margin-left: 25px;">
<p class="PdfParaStyle08"><span class="PdfCharStyle5">&#160;</span><span class="PdfCharStyle4">Description (JSON SYNTAX ONLY) The text that will be pushed into the Note Summary (60 chars) and Document Description (80 chars) fields</span></p>
</li>
<li class="p-PdfParaStyle09" style="margin-top: 0px; margin-left: 25px;">
<p class="PdfParaStyle09"><span class="PdfCharStyle5">&#160;</span><span class="PdfCharStyle4">Doctype Used to set the Document Category Field (20 chars) (Default Value: “note”)</span></p>
</li>
</ul>
<h3><span class="PdfCharStyle4">Weblog Keywords</span></h3>
<p class="PdfParaStyle07"><span class="PdfCharStyle3">The last set of keywords apply to Weblogs only, which can be</span> <span class="PdfCharStyle3" style="font-weight: bold;">created</span> <span class="PdfCharStyle3">using this Email Processor method. Weblog type emails should be sent separate from “ID” type emails but do not have to be.</span> <span class="PdfCharStyle7">&#160;</span></p>
<ul style="list-style: disc;">
<li class="p-PdfParaStyle08" style="margin-top: 11px; margin-left: 25px;">
<p class="PdfParaStyle08"><span class="PdfCharStyle5">&#160;</span>&#160;<span class="PdfCharStyle6">&#160;</span><span class="PdfCharStyle4">Wlsite Client Site Id, used to create Web Log (required for weblog)</span></p>
</li>
<li class="p-PdfParaStyle09" style="margin-top: 0px; margin-left: 25px;">
<p class="PdfParaStyle09"><span class="PdfCharStyle5">&#160;</span>&#160;<span class="PdfCharStyle6">&#160;</span><span class="PdfCharStyle4">Wleqp Client Site Equipment Id, used to create Web Log (required for weblog)</span></p>
</li>
<li class="p-PdfParaStyle09" style="margin-top: 0px; margin-left: 25px;">
<p class="PdfParaStyle09"><span class="PdfCharStyle5">&#160;</span>&#160;<span class="PdfCharStyle6">&#160;</span><span class="PdfCharStyle4">Wlsender Submitted By, sets the Weblog's Submitted By Field, (Defaults to “AutoEmail”) (30</span> chars)</p>
</li>
<li class="p-PdfParaStyle09" style="margin-top: 0px; margin-left: 25px;">
<p class="PdfParaStyle09"><span class="PdfCharStyle5">&#160;</span>&#160;<span class="PdfCharStyle6">&#160;</span><span class="PdfCharStyle4">Wlcode Work Code Id, used to create Web Log (Defaults to “zero record”)</span></p>
</li>
</ul>
<p class="PdfParaStyle11">The recipient of the email used to send attachments to the SAMPro records is a generic inbox specified in the configuration registry during implementation. In our example we have a generic gmail account.</p>
<h2>Subject Syntax:</h2>
<p class="PdfParaStyle03">There are two methods of syntax. JSON is intended to be used by a control system or application (more on this later), while the Human friendly syntax uses a simple syntax of “[<span style="background-color: #ffff80;">Token</span><span style="background-color: #00ff00;">(Value)</span> <span style="background-color: #ff00ff;">Doctype(Category)</span>] <span style="background-color: #00ffff;">Subject</span>.” The Token is the record in which the email will attach to. The Value is the ID of the specific record. The Subject will be the Description of the attachment.</p>
<ul style="list-style: disc;">
<li class="p-PdfParaStyle08" style="margin-top: 11px; margin-left: 25px;">
<p class="PdfParaStyle08"><span class="PdfCharStyle5">&#160;</span>&#160;<span class="PdfCharStyle6">&#160;</span><span class="PdfCharStyle3">Human Syntax</span></p>
<ul style="list-style: disc;">
<li class="p-PdfParaStyle13" style="margin-top: 0px; margin-left: 40px;">
<p class="PdfParaStyle13"><span class="PdfCharStyle9">&#160;</span>&#160;<span class="PdfCharStyle6">&#160;</span><span class="PdfCharStyle3">[</span><span class="PdfCharStyle3" style="background-color: #ffff80;">WO</span><span class="PdfCharStyle3" style="background-color: #00ff00;">(100076)</span> <span class="PdfCharStyle3"></span><span class="PdfCharStyle3" style="background-color: #ff00ff;">Doctype(PurchaseOrder)</span><span class="PdfCharStyle3">]</span> <span class="PdfCharStyle3" style="background-color: #00ffff;">PO from Customer</span></p>
</li>
</ul>
</li>
</ul>
<p class="PdfParaStyle14">Doctype(category) is only needed if specifying a category other than note.</p>
<p style="margin-top: 28px; margin-left: 0px; margin-right: 0px; text-indent: 0px;"><img src="SAMPro_Email_Processor_Customer_Instructions_2_00.png" alt="" title="" width="627" height="359" border="0" /> <img src="SAMPro_Email_Processor_Customer_Instructions_2_01.png" alt="" title="" width="627" height="148" border="0" /></p>
<p class="PdfParaStyle06">Here we can see the PDF attachment, as well as the simplified text note generated on this work order: <img src="SAMPro_Email_Processor_Customer_Instructions_3_00.png" alt="" title="" width="627" height="307" border="0" /></p>
<h3>Additional examples:</h3>
<p class="PdfParaStyle15" style="margin-left: 48px;">[<span style="background-color: #ffff80;">Job</span><span style="background-color: #00ff00;">(1S100011)</span>] <span style="background-color: #00ffff;">Tasks for technician</span></p>
<p class="PdfParaStyle15" style="margin-left: 48px;"><img src="SAMPro_Email_Processor_Customer_Instructions_4_00.png" alt="" title="" width="627" height="465" border="0" /></p>
<ul style="list-style: disc;">
<li class="p-PdfParaStyle13" style="margin-top: 0px; margin-left: 65px;">
<p class="PdfParaStyle13"><span class="PdfCharStyle9">&#160;</span>&#160;<span class="PdfCharStyle6">&#160;</span><span class="PdfCharStyle3">[</span><span class="PdfCharStyle3" style="background-color: #ffff80;">Job</span><span class="PdfCharStyle3" style="background-color: #00ff00;">(1S100011)</span><span class="PdfCharStyle3">]</span> <span class="PdfCharStyle3" style="background-color: #00ffff;">Tasks for technician</span></p>
</li>
</ul>
<p style="margin-top: 16px; margin-right: 0px; margin-left: 40px;">&#160;<img src="SAMPro_Email_Processor_Customer_Instructions_4_01.png" alt="" title="" width="627" height="235" border="0" /></p>
<p>In this example, the email has attached as a document on the Job with category of “Note” (none specified). The Word attachment from the email has also attached as a separate document record with default category of “docx-Attachment.”</p>
<p class="PdfParaStyle15" style="margin-left: 48px;">&#160;</p>
<p class="PdfParaStyle15" style="margin-left: 48px;">FW: [<span style="background-color: #ffff80;">Vendor</span><span style="background-color: #00ff00;">(ABC0001)</span> <span style="background-color: #ff00ff;">Doctype(VendorInfo)</span>] <span style="background-color: #00ffff;">Valid Insurance</span></p>
<p class="PdfParaStyle15" style="margin-left: 48px;">[<span style="background-color: #ffff80;">Quote</span><span style="background-color: #00ff00;">(10017)</span>] <span style="background-color: #00ffff;">VENDOR ESTIMATE</span></p>
<h3><span class="PdfCharStyle4">Weblog examples:</span></h3>
<p style="margin-left: 48px;"><span class="PdfCharStyle4">[</span><span style="background-color: #ffff80;">wo</span><span style="background-color: #00ff00;">(100093)</span> <span style="background-color: #ff00ff;">Wlsite(10033) Wleqp(HVAC) Wlsender(kelly) Wlcode(H-NOCOOL)</span>]<span style="background-color: #00ffff;">Recommendation</span> (shown below)</p>
<p style="margin-left: 48px;">[<span style="background-color: #ffff80;">wo</span><span style="background-color: #00ff00;">(100093)</span> <span style="background-color: #ff00ff;">Wlsite(10033) Wleqp(HVAC)</span>] <span style="background-color: #00ffff;">Unit Recommendation</span></p>
<p style="margin-left: 48px;">FW: [<span style="background-color: #ffff80;">job</span><span style="background-color: #00ff00;">(1s100011)</span> <span style="background-color: #ff00ff;">Wlsite(10033) Wleqp(HVAC) Wlcode(H-NOCOOL)</span>] <span style="background-color: #00ffff;">Recommendation.</span></p>
<p style="margin-left: 48px;">&#160;</p>
<p style="margin-top: 0px; margin-left: 43px; margin-right: 0px; text-indent: 0px;"><img src="SAMPro_Email_Processor_Customer_Instructions_3_01.png" alt="" title="" width="531" height="303" border="0" /></p>
<h3>Multiple ID's:</h3>
<p class="PdfParaStyle06">Multiple “ID” tokens can be combined to attach documents to multiple records simultaneously.</p>
<p class="PdfParaStyle22"><span class="PdfCharStyle9">&#160;</span>&#160;<span class="PdfCharStyle6">&#160;</span><span class="PdfCharStyle3">[</span><span class="PdfCharStyle3" style="background-color: #ffff80;">wo</span><span class="PdfCharStyle3" style="background-color: #00ff00;">(100076)</span> <span class="PdfCharStyle3"></span><span class="PdfCharStyle3" style="background-color: #ffff80;">job</span><span class="PdfCharStyle3" style="background-color: #00ff00;">(1C100012)</span> <span class="PdfCharStyle3"></span><span class="PdfCharStyle3" style="background-color: #ffff80;">vendor</span><span class="PdfCharStyle3" style="background-color: #00ff00;">(ABC0001)</span><span class="PdfCharStyle3">]</span> <span class="PdfCharStyle3" style="background-color: #00ffff;">Subject/Description of email/attachment</span></p>
<p class="PdfParaStyle13"><span class="PdfCharStyle9">&#160;</span>&#160;<span class="PdfCharStyle6">&#160;</span><span class="PdfCharStyle3">[</span><span class="PdfCharStyle3" style="background-color: #ffff80;">wo</span><span class="PdfCharStyle3" style="background-color: #00ff00;">(100078)</span> <span class="PdfCharStyle3"></span><span class="PdfCharStyle3" style="background-color: #ffff80;">site</span><span class="PdfCharStyle3" style="background-color: #00ff00;">(1S100011)</span> <span class="PdfCharStyle3"></span><span class="PdfCharStyle3" style="background-color: #ffff80;">Quote</span><span class="PdfCharStyle3" style="background-color: #00ff00;">(10013)</span><span class="PdfCharStyle3">]</span> <span class="PdfCharStyle3" style="background-color: #00ffff;">Photo of RTU2</span></p>
<p class="PdfParaStyle23" style="color: #ff0000;">***The space between parenthesis and next token is required***</p>
<h3>JSON Syntax:</h3>
<p class="PdfParaStyle24"><span class="PdfCharStyle3">The JSON syntax is a standard JSON structure using the Object notation. This is intended to be used by control systems and the like. Note that the description is no longer the remainder of the subject but a dedicated keyword. Also, the text before and after the JSON is completely ignored.</span> <span class="PdfCharStyle4">&#160;</span></p>
<ul style="list-style: disc;">
<li class="p-PdfParaStyle08" style="margin-top: 11px; margin-left: 25px;">
<p class="PdfParaStyle08"><span class="PdfCharStyle5">&#160;</span>&#160;<span class="PdfCharStyle6">&#160;</span><span class="PdfCharStyle3">JSON Syntax</span></p>
<ul style="list-style: disc;">
<li class="p-PdfParaStyle13" style="margin-top: 0px; margin-left: 40px;">
<p class="PdfParaStyle13"><span class="PdfCharStyle9">&#160;</span>&#160;<span class="PdfCharStyle6">&#160;</span><span class="PdfCharStyle3">{WO:"100076", Description:"PO from Customer", doctype:"VendorInfo"}</span></p>
</li>
</ul>
</li>
</ul>
<h3>Special Configuration Settings:</h3>
<p class="PdfParaStyle03">WebViewableTech = Y or N</p>
<p class="PdfParaStyle03">WebViewableCRM = Y or N</p>
<p class="PdfParaStyle03">WebViewableCSR = Y or N</p>
<p class="PdfParaStyle03">WebViewableSub = Y or N</p>
<p class="PdfParaStyle03"><span class="PdfCharStyle3">WeblogFailEmail =</span> <span class="PdfCharStyle4">email address notified when weblog fails to create</span></p>
<p class="PdfParaStyle03"><span class="PdfCharStyle3">VerboseLogging = True or False</span> <span class="PdfCharStyle4">(turns on error log functionality)</span></p>
<p class="PdfParaStyle03"><span class="PdfCharStyle3">StripDomain =</span> <span class="PdfCharStyle4">email.com (domain of company sender) **</span></p>
<p class="PdfParaStyle26">**StripDomain will remove the domain from the email address listed in the document and note viewers IF the length of the email subject surpasses max characters in either of those field. Document titles may have 80 characters, and note titles may have 60 characters max.</p>
<script type="text/javascript" language="javascript1.2">
//<![CDATA[
<!--
if (window.writeIntopicBar)
        writeIntopicBar(0);


highlightSearch();
//-->
//]]>
</script>
</body>
</html>
