<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head>

  <script type="text/javascript" language="JavaScript">
    //<![CDATA[
    function reDo() {
      if (innerWidth != origWidth || innerHeight != origHeight)
        location.reload();
    }
    if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
      origWidth = innerWidth;
      origHeight = innerHeight;
      onresize = reDo;
    }
    onerror = null;
  //]]>
  </script>
  <style type="text/css">/*<![CDATA[*/

    < !-- div.WebHelpPopupMenu {
      position: absolute;
      left: 0px;
      top: 0px;
      z-index: 4;
      visibility: hidden;
    }

    p.WebHelpNavBar {
      text-align: right;
    }

    -->
  
/*]]>*/</style>

  <script type="text/javascript">//<![CDATA[

    gRootRelPath = ".";
    gCommonRootRelPath = ".";
    gTopicId = "2.18.20.0_5";
  
//]]></script>

  <script type="text/javascript" src="./template/scripts/rh.min.js"></script>
  <script type="text/javascript" src="./template/scripts/common.min.js"></script>
  <script type="text/javascript" src="./template/scripts/topic.min.js"></script>
  <script type="text/javascript" src="./template/scripts/topicwidgets.min.js"></script>
<script type="text/javascript" src="./whxdata/projectsettings.js"></script>
  <link rel="stylesheet" type="text/css" href="./template/styles/topic.min.css"/>
  <link rel="stylesheet" type="text/css" href="./template/single_page/topicheader.css"/>
  <meta name="topic-status" content="Draft"/>

  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <meta name="MS-HKWD" content="service invoice"/>
  <meta name="MS-HKWD" content="sys-report-serviceinvoice"/>
  <meta name="MS-HKWD" content="registry"/>
  <meta name="MS-HKWD" content="autoemail"/>
  <meta name="MS-HKWD" content="price code"/>
  <meta name="topic-status" content="Sent for Review"/>
  <meta name="topic-check-list" content="Ran Smart Index"/>
  <meta name="generator" content="Adobe RoboHelp 2020"/>
  <title>Registry_Entry_Report_Service_Invoice</title>
  <link rel="StyleSheet" href="assets/css/sampro.css" type="text/css"/>
  <meta name="rh-index-keywords" content="service invoice,sys-report-serviceinvoice,registry,autoemail,price code"/>
</head>

<body>
  <div class="topic-header rh-hide" id="rh-topic-header">
    <div class="logo">
    </div>
    <div class="nav">
      <div class="title" title="Registry_Entry_Report_Service_Invoice">
        <span>Registry_Entry_Report_Service_Invoice</span>
      </div>
      <div class="gotohome" title="Click here to see this page in full context">
        <a href="#" onclick="rh._.goToFullLayout()">Click here to see this page in full context</a>
      </div>
    </div>
  </div>
  <div class="topic-header-shadow rh-hide" id="rh-topic-header-shadow"></div>



  <h1>Registry Report Service Invoice (sys-report-serviceinvoice)</h1>
  <h2>Purpose:</h2>
  <p>Set default values for service compute invoices.</p>
  <p class="Body_Text_Indent" style="border-top: 0.50pt solid #000000; border-bottom: 0.50pt solid #000000; 
	 border-left: 0.50pt solid #000000; border-right: 0.50pt solid #000000;">
    <font color="#FF0000" style="font-weight: bold;">Testing Your Registry Entries</font><br/>
    <font style="font-weight: bold; font-style: italic;">The system does not verify the validity of registry entries.</font> Be sure to <font style="font-weight: bold;">test</font> your registry entries after completing them to verify that they are functioning correctly.
  </p>
  <p class="Body_Text_Indent" style="border-top: 0.50pt solid #000000; border-bottom: 0.50pt solid #000000; 
	 border-left: 0.50pt solid #000000; border-right: 0.50pt solid #000000;">
    <font color="#FF0000" style="font-weight: bold; font-style: italic;">Setting</font>
    <font color="#FF0000" style="font-weight: bold; font-style: italic;">Values are Uppercase-Lowercase Sensitive:</font><br/>
    The Setting Value is case-sensitive: be sure that you enter the value <font style="text-decoration: underline; ">exactly</font> as specified in the documentation. If the documentation specifies a value of <font style="font-weight: bold;">true</font>, do NOT enter <font style="font-weight: bold;">True</font> or <font style="font-weight: bold;">TRUE</font>.
  </p>
  <h2>Related Registry Entries:</h2>
  <p><a href="Registry_Entry_Start_Service_Billing_Compute.htm">Registry Entry Start Service Billing Compute</a> including <a href="Registry_Entry_Start_Service_Billing_Compute.htm#Invoice_Backer_Terms_and_Conditions_Page">Terms and Conditions Page</a></p>
  <p><a href="Registry_Entry_to_Autosave_Report.htm">Registry Report Graphics, Max Lines per Page and Autosave</a></p>
  <p><a href="Registry_Entry_to_Autosave_Report.htm#Registry_Entry_for_Report_Emailing">Registry option to Auto-Email Service Invoices</a>.</p>
  <h2>Important Fields:</h2>
  <p>
    <font style="font-weight: bold;">Id:</font>
    <font style="font-weight: bold;">sys-report-serviceinvoice</font>
  </p>
  <p class="Normal_Indent" style="margin-left: 5.75pt;">See the Standard Registry section in <a href="Registry_Viewer.htm">Registry Viewer</a> for additional Registry Id formats to allow entries for specific Users, Branches, Security, or User Groups to override the main entry.</p>
  <h5 class="Normal_Indent" style="margin-left: 8px;"><span style="font-weight: bold;">Service Invoice Saved in Monthly Directories</span> </h5>
  <p style="margin-left: 8px;">The revised Service Invoice reports</p>
  <p style="margin-left: 8px;">SERVICEINVOICE_v91b054.rpt dated 2021-10-07 and</p>
  <p style="margin-left: 8px;">SERVICEINVOICE_v90b028.rpt dated 2021-09-23</p>
  <p style="margin-left: 8px;">Include new section directory functionality so that reports will be stored in monthly subfolders off of the &#39;Invoices&#39; directory.  This change was made to improve performance when a service invoice is saved. Note that the autosavedirectory key must include ^sectiondirectory^ as the last element of the directory path:</p>
  <p style="margin-left: 88px; text-decoration: underline; ">Example:</p>
  <p style="margin-left: 88px;">Id: sys-report-serviceinvoice</p>
  <p style="margin-left: 88px;">Setting Key: autosavedirectory   Setting Value: \\Sampro\docs\^sectiondirectory^</p>
  <p style="margin-left: 88px;">In the above scenario, a service invoice would be saved in the following location in November, 2021:</p>
  <p style="margin-left: 88px;">\\Sampro\docs\Invoices\2021-11</p>
  <p style="margin-left: 48px;">&quot;Invoices&#39; is defined as the sectiondirectory in earlier versions of the Service Invoice report, so these invoices would be stored in the \invoices directory.</p>
  <h3 class="Normal_Indent">Apply Performance Enhancements to the Service Invoice</h3>
  <p><span style="font-weight: bold;">Id:</span> sys-report-serviceinvoice</p>
  <p><span style="font-weight: bold;">Setting Key:</span> ReportExtended   <span style="font-weight: bold;">Setting Value:</span> true   (default false)</p>
  <p>This will enable the functionality for the Service Invoice (assuming that the <a href="Report_Performance_Enhancement.htm">sys-behavior-reports registry</a> is not enabled or set to false). The enhancement will appear when the report is being displayed.</p>
  <h3>Inventory Description – Set from Pricing Code Only</h3>
  <p>
    <font style="font-weight: bold;">Setting Key</font>
    <font style="font-weight: bold;">:</font> ShowOnlyInvntryDesc <font style="font-weight: bold;">Setting Value:</font> Y
  </p>
  <p>The system now sets the work order inventory description using the Price Code (if the description is completed) and the Inventory Price Exceptions tables (shown on the Inventory Item Pricing tab). This registry option enables you to only include the Inventory Description on service compute invoices – it is designed for companies that do not want the internal part name to appear on customer invoices. Note that the Description defaults from the Inventory Name if there is no Price Code or the description in the Price Code is blank.</p>
  <h3>Enable Auto-Emailing the Service Invoice</h3>
  <p>
    <font style="font-weight: bold;"><b>S</b>etting Key:</font> autoemail<font style="font-weight: bold;">  Setting Value:</font> true  
  </p>
  <p><b>Setting Key:</b> autoemailwhenprinted   <b>Setting Value:</b> true</p>
  <p>
    <font style="font-weight: bold;">Setting Key:</font> emailbysection <font style="font-weight: bold;"> Setting Value:</font> true
  </p>
  <h3 class="MsoNormal">Print Both Billing and Email Address on Emailed Invoices</h3>
  <p>The Report Service Invoice (SERVICEINVOICEv90b028.rpt) dated 2017-05-16 supports a registry setting which will allow both the Billing Address and Email To information to print on the invoice header. When this registry setting is enabled AND autoemailwhenprinted and autoemail are BOTH set to true, the physical address will display so that it will appear in the envelope window should it need to be mailed; the email address will appear below the physical address.</p>
  <p>When this registry setting is enabled but autoemailwhenprinted and autoemail are both NOT set to true, only the physical address will display.</p>
  <p><span style="font-weight: bold;">Registry Id:</span> sys-report-serviceinvoice</p>
  <p><span style="font-weight: bold;">Setting Key:</span> ShowBillAddressAndEmailAddress  <span style="font-weight: bold;"> Setting Value:</span> true   (default false)</p>
  <h3>Option to prevent Emailing Zero Dollar Service Invoice</h3>
  <p>This option applies specifically to Service Invoicing and can be used to prevent the emailing of zero-dollar invoices when the service invoice is printed and posted. The invoice will appear on the screen and saved (if enabled) but it will not be emailed to the customer.</p>
  <p>
    <font style="font-weight: bold;">Id:</font> sys-report-serviceinvoice
  </p>
  <p>
    <font style="font-weight: bold;">Setting Key:</font> SkipEmailZeroInvoice <font style="font-weight: bold;">Setting Value:</font> Y (default is N)
  </p>
  <h3><a name="Specify_Bitmap_by_Sites_AccountManager__ServiceManager__Dispatcher_or_Branch" id="Specify_Bitmap_by_Sites_AccountManager__ServiceManager__Dispatcher_or_Branch"></a>Specify Bitmap by Site&#39;s Account Manager, Service Manager, Dispatcher or Branch</h3>
  <p>When printing Service Invoices, the system will look at the Client Site record referenced in the Work Order or Quote to find the appropriate record id to check for an override id match. If it is referenced in the registry, the override bitmap will be used. If an override bitmap is NOT specified, the system will use the standard bitmap (Setting Key: bitmap) specified in the registry.  It your firm has multiple registry entries (e.g., by Security, Branch, Users, etc.) the additional registry options should be added to each registry record.</p>
  <p>A revised version of the Service Invoice SERVICEINVOICEv80b017.rpt) dated 9/19/2014 or later is also required to implement this functionality:</p>
  <p><span style="font-weight: bold;">Id:</span> sys-report-serviceinvoice</p>
  <p><span style="font-weight: bold;">Setting Key:</span> BitmapOverrideBasedOn    <span style="font-weight: bold;">Setting Value:</span> <span style="font-style: italic;">FieldInClientSite</span></p>
  <p>This option turns on the override behavior, and defines which record in the Client Site will be used to define the bitmap override. Valid values are:</p>
  <p style="margin-left: 48px;">accountmanager<br/>
    branch<br/>
    servicemanager<br/>
    dispatcher</p>
  <p><span style="font-weight: bold;">Setting Key:</span> <span style="font-style: italic;">FieldInClientSite~RecordId</span>  <span>
      <font style="font-style: normal; font-weight: bold;">Setting Value:</font>
    </span> <span style="font-style: italic;">sharepath\bitmap.bmp</span></p>
  <p>This entry defines matches the override with the bitmap.  One entry needs to be created for each override bitmap. The Setting Key defines the field and individual record Id; the Setting Value defines the bitmap.  </p>
  <p><span style="text-decoration: underline; ">Example:  Use the Client Site&#39;s Account Manager to Specify the Override</span></p>
  <p>In this example, assume that Jean,Tim, Joe and Sarah are account managers. Jean and Tim need special overrides; Joe and Sarah do not.</p>
  <p style="margin-left: 48px;">Id: sys-report-serviceinvoice</p>
  <p style="margin-left: 48px;">Setting Key: BitmapOverrideBasedOn    Setting Value: accountmanager</p>
  <p style="margin-left: 48px;">Turns on the override.</p>
  <p style="margin-left: 48px;"><span style="font-style: italic;">S</span>etting Key: AccountManager~Tim  <span>
      <font style="font-style: normal;">Setting Value:</font>
    </span> <span style="font-style: italic;">sharepath\</span>Tim_invoice.bmp</p>
  <p style="margin-left: 48px;"><span style="font-style: italic;">S</span>etting Key: AccountManager~Jean  <span>
      <font style="font-style: normal;">Setting Value:</font>
    </span> <span style="font-style: italic;">sharepath\</span>Jean_invoice.bmp</p>
  <p style="margin-left: 48px;">Specifies the override for service invoices for Client Sites with Tim or Jean as Account Managers.</p>
  <p style="margin-left: 48px;">Setting Key: Bitmap    Setting Value: <span style="font-style: italic;">sharepath/</span>Company_invoice.bmp</p>
  <p style="margin-left: 48px;">Provides the default bitmap for Account Managers Joe and Sarah, and for service invoices generated for Client Sites without an Account Manager specified.</p>
  <p style="margin-left: 48px;"><strong>Bitmap Override by Dispatcher</strong><br/>
    <strong>Id: </strong>sys-report-serviceinvoice
  </p>
  <p style="margin-left: 48px;"><strong>Setting Key: </strong>BitmapOverrideBasedOn   <strong> Setting Value: </strong>dispatcher</p>
  <p style="margin-left: 48px;"><strong>Setting Key:</strong> FieldInClientSite~RecordId  <strong>Setting Value:</strong> sharepath\bitmap.bmp</p>
  <h3><a id="Specify_Bitmap_Override_by_Job_"></a> Specify Bitmap Override by Job</h3>
  <p>The revised Service Invoice (SERVICEINVOICEv90b028.rpt) dated 2018-05-14 supports the new bitmap override by Job functionality.  </p>
  <p><span style="font-weight: bold;">Registry Id:</span> sys-report-serviceinvoice</p>
  <p><span style="font-weight: bold;">Setting Key:</span>  BitmapOverrideBasedOn   <span style="font-weight: bold;">Setting Value:</span> job</p>
  <p>This registry entry defines that this override is based on a user field in the invoice&#39;s Job record.</p>
  <p><span style="font-weight: bold;">Setting Key:</span> BitmapOverrideField  <span style="font-weight: bold;">Setting Value:</span> <span style="font-style: italic;">job user database field</span></p>
  <p>This registry entry specifies exactly Job User field will provide the override; the database field name must be specified. For example, the following specifies the Job&#39;s User 3 field:</p>
  <p style="margin-left: 48px;">Setting Key: BitmapOverrideField  Setting Value: jb_usr3</p>
  <p style="margin-left: 8px;"><span style="font-weight: bold;">Setting Key:</span> Job~<span style="font-style: italic;">string</span>   <span style="font-weight: bold;">Setting Value:</span> <span style="font-style: italic;">path\bitmap.</span>bmp</p>
  <p style="margin-left: 8px;">This entry provide the override bitmap file that will be used if the Job record&#39;s User field defined above contains the string specified.  Notice that a tilde (~) separates Job from the string. As many of these entries may be made as needed to support the various bitmaps.</p>
  <p style="margin-left: 48px;">Example:</p>
  <p style="margin-left: 48px;">Suppose that we have a bitmap file named 010101_invoice.bmp that should be used on invoices associated with Job&#39;s having the following text string 010101 in Job User 3 fields.</p>
  <p style="margin-left: 48px;">Setting Key: Job~010101  Setting Value: <span style="font-style: italic;">path\</span>010101_invoice.bmp</p>
  <p style="margin-left: 8px;"><span style="font-weight: bold;">Tip:</span> Include the part of the bitmap name as the text string for clarity.</p>
  <p style="margin-left: 8px;"><span style="font-weight: bold;">Tip: </span>Including the appropriate values in your job templates will ensure that new jobs are created properly. In addition, using the Custom Fields functionality to specify the allowed values will prevent inappropriate values from being entered.</p>
  <h3><a name="Customize_Service_Invoice_Email_Message" id="Customize_Service_Invoice_Email_Message"></a>Customize Service Invoice Email Message</h3>
  <p>The Service Invoice (SERVICEINVOICEv90b028.rpt) dated 2017-05-26 and this release supports the ability to include custom text in the email message that the Service Invoice is attached to.</p>
  <p>A Common Phrase entry must be made which contains the new email message. If the common phrase includes a url in the standard form www.mycompany.com it will appear as a link in the email.  </p>
  <p>Token replacements can done with fields from the following tables:</p>
  <p style="margin-left: 48px;">clnt, clntste, invcemstr, jb, wrkordr</p>
  <p style="margin-left: 48px;">Fields should be referenced using database field names <br style="font-family: Verdana, &#39;Helvetica Neue&#39;, Helvetica, Arial, sans-serif; 
	 font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; 
	 orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; text-decoration-style: initial; 
	 text-decoration-color: initial;"/>
    (i.e. invcemstr_id, wrkordr_dte_opnd, clnt_nme)</p>
  <p><span style="font-weight: bold;">Registry Id:</span> sys-report-serviceinvoice</p>
  <p><span style="font-weight: bold;">Setting Key:</span> EmailMessageId   <span style="font-weight: bold;">Setting Value:</span> <span style="font-style: italic;">commonphraseid</span></p>
  <p>In the absence of the registry, &quot;Emailed Report Attached&quot; will be included in the email body.</p>
  <h3>Service Invoice Token Replacement for Email Subject</h3>
  <p>The new functionality is enabled in this version with the revised Report Service Invoice (SERVICEINVOICEv90b028.rpt) dated 2018-01-16. The following registry is required:</p>
  <p><span style="font-weight: bold;">Id:</span> sys-report-serviceinvoice</p>
  <p><span style="font-weight: bold;">Setting Key:</span> EmailSubject  <span style="font-weight: bold;">Setting Value:</span> <span style="font-style: italic;">Text string which supports token replacement</span></p>
  <p>Token replacements can done with fields from the following tables:</p>
  <p>clnt, clntste, invcemstr, jb, wrkordr</p>
  <p>Fields should be referenced using database field names <br style="font-family: Verdana, &#39;Helvetica Neue&#39;, Helvetica, Arial, sans-serif; 
														 font-size: 14px; 
														 font-variant-ligatures: normal; 
														 font-variant-caps: normal; 
														 orphans: 2; widows: 2; 
														 -webkit-text-stroke-width: 0px; 
														 text-decoration-style: initial; 
														 text-decoration-color: initial;"/>
    (i.e. invcemstr_id, wrkordr_dte_opnd, clnt_nme)</p>
  <p style="margin-left: 48px; text-decoration: underline; ">Example:</p>
  <p style="margin-left: 48px;">Setting Key: EmailSubject   Setting Value: Invoice ^invcemstr_id^ for ^clnt_id^</p>
  <h3>Attach TechAnywhere Receipts and Other Documents to Emailed Invoices</h3>
  <p>This release adds the ability to append TechAnywhere receipts or other documents to the PDF&#39;d version of Service Invoices. This allows an Invoice Package to be automatically emailed to customers configured to receive Service Invoices via email. Supported document attachment file types include: .bmp, .jpg, .gif, .png,  and .pdf. This functionality is suitable for scenarios where a Work Order is only invoiced once.</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Important:  Only the PDF&#39;d Invoice Includes the Attachments</span><br/>
    The .dbr version of the Service Invoice will not display the attached documents; it will however include a list of attached files. Only the PDF&#39;d version of this document will include the &#39;package&#39; of document attachments.</p>
  <p style="margin-left: 48px;">To enable this functionality:</p>
  <p style="margin-left: 48px;">1. The revised Service Invoice serviceinvoicev90b028.rpt dated 2017/02/28 or later must be installed in your database. This report also supports logic to process archive file locations when compiling an invoice with attached TechAnywhere Receipts or other files.  </p>
  <p style="margin-left: 48px;">2. The Client Site Email Invoices field (a-clntste: clntste.eml-invce) must contain a list of the Document Categories which should be included in the Invoice Package. The included documents must be attached to the Work Order being invoiced prior to the generation of the invoice. Any documents attached to the Work Order after an invoice is generated will not be included in this package.</p>
  <p style="margin-left: 48px;">For example, to include TechAnywhere Receipts in the Invoice Package for a particular Site, you would enter <span style="font-weight: bold;">Receipt</span> in its Email Invoices field.</p>
  <p style="margin-left: 48px;">3. Verify that the xmlToPdf.jar file (located in the same directory as your SAMPro executable) is dated 2015/07/08 or later.</p>
  <p style="margin-left: 48px;">4. Implement the following registry entries:</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Id:</span> sys-start-ssrvcebllngcmpte</p>
  <p style="margin-left: 88px;"><span style="font-weight: bold;">IMPORTANT:</span>  The following two options must be specified in the registry for Start Compute Service Invoice registry (sys-start-ssrvcebllngcmpte).</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Setting Key:</span> IncludeInvoiceDocuments   <span style="font-weight: bold;">Setting Value:</span> true    (default false)</p>
  <p style="margin-left: 48px;">This option is required to implement the new &#39;package&#39; functionality.</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Setting Key:</span> SkipPrintEmailedInvoices   <span style="font-weight: bold;">Setting Value:</span> true</p>
  <p style="margin-left: 48px;">Implementing this registry allows emailed invoices to be &#39;skipped&#39; in the print run.  Processing will proceed as usual: the Invoices will be displayed and sent to the printer; the user must then confirm that the invoices have printed and post them. However, only those invoices that were not emailed will actually be printed.</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Id:</span> sys-report-serviceinvoice:</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Setting Key:</span> sectionbackerbitmap   <span style="font-weight: bold;">Setting Value:</span> <span style="font-style: italic;">Pathname</span>\whitesquare.bmp</p>
  <p style="margin-left: 48px;">This registry is recommended to prevent the invoice bitmap from &#39;stepping on&#39; the attached documents. The bitmap may be obtained from support.</p>
  <p style="margin-left: 88px;"><span style="font-weight: bold;">IMPORTANT:</span> A whitesquare.jpg file must NOT be present in the bitmaps directory or pdf&#39;s or an extra page will be inserted in front for attached pdf&#39;s. If whitesquare.bmp is used by other registries, make a copy of whitesquare.bmp, rename the copy as whitesquare1.bmp, and reference whitesquare1.bmp in this registry option.</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Setting Key:</span> ShowDocumentDescription  <span style="font-weight: bold;">Setting Value:</span> Y</p>
  <p style="margin-left: 48px;">This option should be enabled to display the Document Description of the attached graphic document on the upper left-hand corner of the page. Note that the attachments themselves (along with the Description) are only shown when the invoice is PDF&#39;d.</p>
  <h3>Skip Print Emailed Invoices</h3>
  <p>This release adds the ability to append TechAnywhere receipts or other documents to the PDF&#39;d version of Service Invoices. This allows an Invoice Package to be automatically emailed to customers configured to receive Service Invoices via email. Supported document attachment file types include: .bmp, .jpg, .gif, .png,  and .pdf. This functionality is suitable for scenarios where a Work Order is only invoiced once.</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Important:  Only the PDF&#39;d Invoice Includes the Attachments</span><br/>
    The .dbr version of the Service Invoice will not display the attached documents; it will however include a list of attached files. Only the PDF&#39;d version of this document will include the &#39;package&#39; of document attachments.</p>
  <p>To enable this functionality:</p>
  <p style="margin-left: 48px;">1. The revised Service Invoice serviceinvoicev90b028.rpt dated 2016/02/16 or later must be installed in your database.</p>
  <p style="margin-left: 48px;">2. The Client Site Email Invoices field (a-clntste: clntste.eml-invce) must contain a list of the Document Categories which should be included in the Invoice Package. The included documents must be attached to the Work Order being invoiced prior to the generation of the invoice. Any documents attached to the Work Order after an invoice is generated will not be included in this package.</p>
  <p style="margin-left: 48px;">For example, to include TechAnywhere Receipts in the Invoice Package for a particular Site, you would enter <span style="font-weight: bold;">Receipt</span> in its Email Invoices field.</p>
  <p style="margin-left: 48px;">3. Verify that the xmlToPdf.jar file (located in the same directory as your SAMPro executable) is dated 2015/07/08 or later.</p>
  <p style="margin-left: 48px;">4. Implement the following registry entries:</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Id:</span> sys-start-ssrvcebllngcmpte:</p>
  <p style="margin-left: 88px;"><span style="font-weight: bold;">IMPORTANT:</span>  The following two options must be specified in the registry for Start Compute Service Invoice registry (sys-start-ssrvcebllngcmpte).</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Setting Key:</span> IncludeInvoiceDocuments   <span style="font-weight: bold;">Setting Value:</span> true    (default false)</p>
  <p style="margin-left: 48px;">This option is required to implement the &#39;package&#39; functionality.</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Setting Key:</span> SkipPrintEmailedInvoices   <span style="font-weight: bold;">Setting Value:</span> true</p>
  <p style="margin-left: 48px;">Implementing this registry allows emailed invoices to be &#39;skipped&#39; in the print run.  Processing will proceed as usual: the Invoices will be displayed and sent to the printer; the user must then confirm that the invoices have printed and post them. However, only those invoices that were not emailed will actually be printed.</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Id:</span> sys-report-serviceinvoice:</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Setting Key:</span> sectionbackerbitmap   <span style="font-weight: bold;">Setting Value:</span> <span style="font-style: italic;">Pathname</span>\whitesquare.bmp</p>
  <p style="margin-left: 48px;">This registry is recommended to prevent the invoice bitmap from &#39;stepping on&#39; the attached documents. The bitmap may be obtained from support.</p>
  <p style="margin-left: 88px;"><span style="font-weight: bold;">IMPORTANT:</span> A whitesquare.jpg file must NOT be present in the bitmaps directory or pdf&#39;s or an extra page will be inserted in front for attached pdf&#39;s. If whitesquare.bmp is used by other registries, make a copy of whitesquare.bmo, rename the copy as whitesquare1.bmp, and reference whitesquare1.bmp in this registry option.</p>
  <p style="margin-left: 48px;"><span style="font-weight: bold;">Setting Key:</span> ShowDocumentDescription  <span style="font-weight: bold;">Setting Value:</span> Y</p>
  <p style="margin-left: 48px;">This option should be enabled to display the Document Description of the attached graphic document on the upper left-hand corner of the page. Note that the attachments themselves (along with the Description) are only shown when the invoice is PDF&#39;d.</p>
  <h3>Registry to Skip Print and or Email of Negative Invoices</h3>
  <p class="MsoNormal" style="margin-top: 0in; 
									 margin-right: 1.9pt; margin-bottom: 7.95pt; 
									 margin-left: 6.5pt;">The revised Service Invoice Report (SERVICEINVOICEv90b028) dated 2016-11-11 and this release support registries to skip printing and/or emailing service invoices with a negative total.</p>
  <h5>Registry to Skip Emailing Negative Invoices</h5>
  <p class="MsoNormal" style="margin-top: 0in; 
									 margin-right: 1.9pt; margin-bottom: 7.95pt; 
									 margin-left: 0in; text-indent: 5.75pt;"><b style="mso-bidi-font-weight: normal;">Id:</b> sys-report-serviceinvoice</p>
  <p class="MsoNormal" style="margin-top: 0in; 
									 margin-right: 1.9pt; margin-bottom: 7.95pt; 
									 margin-left: 0in; text-indent: 5.75pt;"><b style="mso-bidi-font-weight: normal;">Setting Key:</b><span style="mso-spacerun: yes;"> </span> SkipEmailNegativeInvoice<span style="mso-spacerun: yes;"> </span> <b style="mso-bidi-font-weight: normal;">Setting Value:</b><span style="mso-spacerun: yes;"> </span> Y (default is N)<span style="mso-spacerun: yes;"> </span></p>
  <h5>Registry to Skip Printing Negative Invoices</h5>
  <p class="MsoNormal" style="margin-top: 0in; 
									 margin-right: 1.9pt; margin-bottom: 7.95pt; 
									 margin-left: 0in; text-indent: 5.75pt;"><b style="mso-bidi-font-weight: normal;">Id:</b><span style="mso-spacerun: yes;"> </span> sys-start-ssrvcebllngcmpte</p>
  <p class="MsoNormal" style="margin-top: 0in; 
									 margin-right: 1.9pt; margin-bottom: 7.95pt; 
									 text-indent: 5.75pt; margin-left: 40px;"><span style="font-weight: bold;">IMPORTANT:</span>  The following option must be specified in the registry for Start Compute Service Invoice registry (sys-start-ssrvcebllngcmpte).</p>
  <p class="MsoNormal" style="margin-top: 0in; 
									 margin-right: 1.9pt; margin-bottom: 7.95pt; 
									 margin-left: 0in; text-indent: 5.0pt;"><b style="mso-bidi-font-weight: normal;">Setting Key:</b><span style="mso-spacerun: yes;"> </span> SkipPrintNegativeInvoices<span style="mso-spacerun: yes;">  </span> <b style="mso-bidi-font-weight: normal;">Setting Value:</b><span style="mso-spacerun: yes;"> </span> true (default is false)</p>
  <h3>Registry to Print Amount Due in Red at Top of First Page</h3>
  <p>The revised Service Invoice report (SERVICEINVOICEv90b028.rpt) dated 2019-01-07 supports a registry setting to print the Amount Due of the invoice on the top of the first page, below the Service Location on the right-hand side of the page. It is printed in bold, red text to stand out. This functionality is supported for the STANDARD and CANADA headers; custom report headers can be updated as needed for a small fee.  </p>
  <p>The following registry is required to enable this functionality.</p>
  <p><span style="font-weight: bold;">Id</span>: sys-report-serviceinvoice</p>
  <p><span style="font-weight: bold;">Setting Key:</span> ShowAmountDuePage1  <span style="font-weight: bold;">Setting Value:</span> true</p>
  <h3>Registry Option to Auto-Email Zero-Dollar PM Invoices</h3>
  <p>This registry gives the option to enable/disable the auto-email behavior as relates to $0.00 Invoices based on the Work Order type associated with the invoice. When this registry is enabled, $0.00 invoices associated with performing Preventative Maintenance visits will be produced and delivered to serve as PM Work Order receipts.</p>
  <p><strong>Id:</strong> sys-report-serviceinvoice</p>
  <p><strong>Setting Key: </strong>SkipEmailZeroInvoiceWOTypeExceptions    <strong>Setting Value:</strong> CSV of wrkordr_type values  <br/>
    <br/>
    <strong>Note: Contact your Support representative for a vital report for this registry. </strong>
  </p>
  <p></p>

</body></html>