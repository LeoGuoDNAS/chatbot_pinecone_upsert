<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head>

  <script type="text/javascript" language="JavaScript">
    //<![CDATA[
    function reDo() {
      if (innerWidth != origWidth || innerHeight != origHeight)
        location.reload();
    }
    if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
      origWidth = innerWidth;
      origHeight = innerHeight;
      onresize = reDo;
    }
    onerror = null;
  //]]>
  </script>
  <style type="text/css">/*<![CDATA[*/

    < !-- div.WebHelpPopupMenu {
      position: absolute;
      left: 0px;
      top: 0px;
      z-index: 4;
      visibility: hidden;
    }

    p.WebHelpNavBar {
      text-align: right;
    }

    -->
  
/*]]>*/</style>

  <script type="text/javascript">//<![CDATA[

    gRootRelPath = ".";
    gCommonRootRelPath = ".";
    gTopicId = "3.3.0_2";
  
//]]></script>

  <script type="text/javascript" src="./template/scripts/rh.min.js"></script>
  <script type="text/javascript" src="./template/scripts/common.min.js"></script>
  <script type="text/javascript" src="./template/scripts/topic.min.js"></script>
  <script type="text/javascript" src="./template/scripts/topicwidgets.min.js"></script>
<script type="text/javascript" src="./whxdata/projectsettings.js"></script>
  <link rel="stylesheet" type="text/css" href="./template/styles/topic.min.css"/>
  <link rel="stylesheet" type="text/css" href="./template/single_page/topicheader.css"/>
  <meta name="topic-status" content="Draft"/>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="MS-HKWD" content="Sybase to SQL"/>
<meta name="MS-HKWD" content="SQL"/>
<meta name="MS-HKWD" content="conversion"/>
<meta name="generator" content="Adobe RoboHelp 2020"/>
<title>Sybase To SQL Server Conversion</title>
<link rel="StyleSheet" href="assets/css/sampro.css" type="text/css"/>

<meta name="rh-index-keywords" content="Sybase to SQL,SQL,conversion"/></head>

<body>
  <div class="topic-header rh-hide" id="rh-topic-header">
    <div class="logo">
    </div>
    <div class="nav">
      <div class="title" title="Sybase To SQL Server Conversion">
        <span>Sybase To SQL Server Conversion</span>
      </div>
      <div class="gotohome" title="Click here to see this page in full context">
        <a href="#" onclick="rh._.goToFullLayout()">Click here to see this page in full context</a>
      </div>
    </div>
  </div>
  <div class="topic-header-shadow rh-hide" id="rh-topic-header-shadow"></div>



<h1>Sybase To SQL Server Conversion</h1>
<h2>Purpose:</h2>
<p>This module may be licensed from Data-Basics if your internal IT staff is sufficiently experienced with database administration for Sybase / SQL Server.</p>
<h2>Warning</h2>
<p>This process should only be undertaken if you are VERY familiar with database manipulations. If you don&#39;t understand what is being done during this process then you shouldn&#39;t be performing the operation. In other words if this document makes 100% perfect sense then you are qualified to use it. If not, stay away from the function.</p>
<h2>Introduction</h2>
<p>This document details the process for converting an existing Sybase Sampro database to a matching SQL Server Sampro database. This involves the following general steps:</p>
<p style="text-indent: 12.25pt;">- Preparing the target SQL Server database and the corresponding Data Source.</p>
<p style="text-indent: 12.25pt;">- Running the conversion function. This will create and load the tables in the target database.</p>
<p style="text-indent: 12.25pt;">- Performing the standard Sampro version update process.</p>
<h2>Step Details</h2>
<p>0. Add the Sybase to SQL Server function to SAM Pro.</p>
<p style="margin-left: 36.00pt;">a. If you have not updated to a new version of SAM Pro recently, the Start Sybase to SQL Conversion function may not appear on your list of Starter functions. If this is the case, run Start Function List Update.</p>
<p style="margin-left: 36.00pt;">b. Log out and back in again; the Start Sybase to SQL Conversion should now appear your list if you are logged on as a member of User Group All. If you are not a member of this Group, you will need to add it to your User Group. Note: access to this function should be severely restricted.</p>
<p style="margin-left: 36.00pt;">c. Note that you must have a vrgstry.cus file in place that allows you access to this feature; this file may be obtained from Data-Basics when your license has been secured.</p>
<p>1. Prepare the SQL Server Database</p>
<p style="text-indent: 30.25pt;">a. Create a new database within the instance.</p>
<p style="margin-left: 36.00pt;">b. Give the new database the appropriate privileges. The user must have sufficient privileges to create tables in the database. The user must also have ‘Bulk Copy’ privileges.</p>
<p>2. Create and validate a Data Source which references the newly created database.</p>
<p>3. Identify the Appropriate Paths</p>
<p>The files used to exchange data between the Sybase server and the SQL Server instance must be stored in a folder accessible to</p>
<p style="margin-left: 36.00pt;">a. The Sybase server</p>
<p style="margin-left: 36.00pt;">b. The SQL Server instance</p>
<p style="margin-left: 36.00pt;">c. The Sampro image.</p>
<p style="margin-left: 36.00pt;">These may require up to 3 different paths. If you are using a UNC (i.e. a pathname beginning with ‘\\’), the same path should apply for all 3 usages.</p>
<p style="margin-left: 36.00pt;">Before continuing to the next step, identify the pathname or pathnames required.</p>
<p>4. Copy the database tables from the current database to the target database</p>
<p style="margin-left: 36.00pt;">a. Run the Start Sybase to SQL Server function.</p>
<p style="margin-left: 36.00pt;">b. Fill out the options screen. See the sample below:</p>
<p><img src="assets/images/image/IMG00031.gif" alt="image\IMG00031.gif" title="image\IMG00031.gif" width="888" height="330" border="0"/></p>
<p style="margin-left: 36.00pt;">c. The following fields are required:</p>
<p style="margin-left: 36.00pt; text-indent: 36.00pt;">Target Data Source Name</p>
<p style="margin-left: 36.00pt; text-indent: 36.00pt;">i. File Path From Sampro</p>
<p style="margin-left: 36.00pt; text-indent: 36.00pt;">ii. File Path From Sybase</p>
<p style="margin-left: 36.00pt; text-indent: 36.00pt;">iii. File Path From SQL Server</p>
<p style="margin-left: 72.00pt;">d. If you make an entry in the Default File Path field, this entry will automatically propagate to the three File Path fields mentioned above.</p>
<p style="margin-left: 72.00pt;">e. If you want the conversion to write an activity log, enter the filename. This file will be written within the folder used for staging the data.</p>
<p style="margin-left: 72.00pt;">f. If you want the conversion to delete each work file after the data has been exported, check the Delete Work Files box.</p>
<p>5. Press the Go! Button. Extensive error checking of path names and database privileges will take place. You must resolve any problems before you will be allowed to proceed.</p>
<p>6. If no errors are identified, you will be asked to confirm that you want to proceed.</p>
<p style="margin-left: 36.00pt;">a. Empty tables will then be created on the target database. If a table already exists in the target database, It is assumed that its schema is correct and no error message is issued.</p>
<p style="margin-left: 36.00pt;">b. Next, the contents of all those files will be copied from the current database to the target database.</p>
<p style="margin-left: 36.00pt;">c. Before moving data to a target database table, the number of rows in the target table is checked. If the table already has rows, no data is copied.</p>
<p style="margin-left: 36.00pt;">d. An error message may be displayed. This usually implies that an invalid character (e.g. ‘|’) has made its way into a table.</p>
<p style="margin-left: 36.00pt;">e. After all the tables have been copied, the Revision Level of the target database will be bumped down one level.</p>
<p style="margin-left: 36.00pt;">f. Finally, a completion message will be displayed.</p>
<p>7. Check the log for errors.</p>
<p>8. Take corrective action if any error messages have been displayed or if the log shows any errors. This might include modifying the contents of the source database (for example, removing any instances of the ‘|’ character in a database table).</p>
<p>9. If you need to reload a table in the target database (e.g, one you had to remove the ‘|’ character from), drop the table and repeat the above process. The dropped table or tables will be re-created and loaded. All other tables will be left untouched.</p>
<p>Once all errors are corrected, you will proceed with the standard SAM Pro upgrade processing on the Target Database</p>
<p>10. Log out of the current database.</p>
<p>11. Log into the target database.</p>
<p>12. Wait for the standard upgrade processing to complete. This processing will establish the appropriate indexes and foreign keys for the database.</p>

</body></html>