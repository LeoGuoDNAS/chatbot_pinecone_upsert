<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head>

  <script type="text/javascript" language="JavaScript">
    //<![CDATA[
    function reDo() {
      if (innerWidth != origWidth || innerHeight != origHeight)
        location.reload();
    }
    if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
      origWidth = innerWidth;
      origHeight = innerHeight;
      onresize = reDo;
    }
    onerror = null;
  //]]>
  </script>
  <style type="text/css">/*<![CDATA[*/

    < !-- div.WebHelpPopupMenu {
      position: absolute;
      left: 0px;
      top: 0px;
      z-index: 4;
      visibility: hidden;
    }

    p.WebHelpNavBar {
      text-align: right;
    }

    -->
  
/*]]>*/</style>

  <script type="text/javascript">//<![CDATA[

    gRootRelPath = ".";
    gCommonRootRelPath = ".";
    gTopicId = "2.18.1.0_5";
  
//]]></script>

  <script type="text/javascript" src="./template/scripts/rh.min.js"></script>
  <script type="text/javascript" src="./template/scripts/common.min.js"></script>
  <script type="text/javascript" src="./template/scripts/topic.min.js"></script>
  <script type="text/javascript" src="./template/scripts/topicwidgets.min.js"></script>
<script type="text/javascript" src="./whxdata/projectsettings.js"></script>
  <link rel="stylesheet" type="text/css" href="./template/styles/topic.min.css"/>
  <link rel="stylesheet" type="text/css" href="./template/single_page/topicheader.css"/>
  <meta name="topic-status" content="Draft"/>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="MS-HKWD" content="archive"/>
<meta name="MS-HKWD" content="scanning"/>
<meta name="MS-HKWD" content="document"/>
<meta name="MS-HKWD" content="sys-document-archive"/>
<meta name="MS-HKWD" content="attachments"/>
<meta name="MS-HKWD" content="registry"/>
<meta name="topic-status" content="Sent for Review"/>
<meta name="generator" content="Adobe RoboHelp 2020"/>
<title>Registry Document Attachment &amp; Scanning (sys-document-archive)</title>
<link rel="StyleSheet" href="assets/css/sampro.css" type="text/css"/>

<meta name="rh-index-keywords" content="archive,scanning,document,sys-document-archive,attachments,registry"/><meta name="brsnext" value="Registry_Entry_to_Retain_inet_log_File.htm"/><meta name="brsprev" value="Registry_Entry_for_Report_Anywhere_Scheduled_Report_Manager.htm"/></head>

<body>
  <div class="topic-header rh-hide" id="rh-topic-header">
    <div class="logo">
    </div>
    <div class="nav">
      <div class="title" title="Registry Document Attachment &amp; Scanning (sys-document-archive)">
        <span>Registry Document Attachment &amp; Scanning (sys-document-archive)</span>
      </div>
      <div class="gotohome" title="Click here to see this page in full context">
        <a href="#" onclick="rh._.goToFullLayout()">Click here to see this page in full context</a>
      </div>
    </div>
  </div>
  <div class="topic-header-shadow rh-hide" id="rh-topic-header-shadow"></div>



<h1>Registry Document Attachment &amp; Scanning (sys-document-archive)</h1>
<h2>Purpose:</h2>
<p>You may attach documents, reports or scanned images to SAM Pro records. 
 When a document is attached, a copy of it will be placed in the directory 
 specified in this registry entry and identified by its internal SAM Pro 
 record number and original filename extension.</p>
<p class="Body_Text_Indent" style="border-top: 0.50pt solid #000000; border-bottom: 0.50pt solid #000000; 
	 border-left: 0.50pt solid #000000; border-right: 0.50pt solid #000000;"><font style="font-weight: bold;" color="#FF0000">Testing Your Registry Entries</font><br/>
<font style="font-weight: bold; font-style: italic;">The system does not 
 verify the validity of registry entries.</font> Be sure to <font style="font-weight: bold;">test</font> 
 your registry entries after completing them to verify that they are functioning 
 correctly.</p>
<p class="Body_Text_Indent" style="border-top: 0.50pt solid #000000; border-bottom: 0.50pt solid #000000; 
	 border-left: 0.50pt solid #000000; border-right: 0.50pt solid #000000;"><font style="font-weight: bold; font-style: italic;" color="#FF0000">Setting</font> 
 <font style="font-weight: bold; font-style: italic;" color="#FF0000">Values 
 are Uppercase-Lowercase Sensitive:</font><br/>
The Setting Value is case-sensitive: be sure that you enter the value <font style="text-decoration: underline; ">exactly</font> as specified in 
 the documentation. If the documentation specifies a value of <font style="font-weight: bold;">true</font>, 
 do NOT enter <font style="font-weight: bold;">True</font> or <font style="font-weight: bold;">TRUE</font>.</p>
<h2>Usage:</h2>
<p>When a user accesses an attached file from SAM Pro, a copy if it will 
 be placed in the user’s temporary directory – that copy may be edited, 
 printed, etc., but the original file attached to SAM Pro will not be affected. 
 If it is necessary, a revised file must be attached to the appropriate 
 SAM Pro record.</p>
<p>To enable scanning, the document archiving directory must be set. In 
 addition, a directory for storing the scanned documents should be set.</p>

<p><font style="font-weight: bold;">Important Note on Redisplaying</font> 
 <font style="font-weight: bold;">Saved</font> <font style="font-weight: bold;">Reports</font> 
 - In V8.1 and up, the bitmap path is saved in the dbr file itself, so 
 that the registry is not required to display the bitmap when the report 
 is redisplayed. If the saved report is from an earlier release where the 
 bitmap path was not saved, the applicable registry entry will be used. 
 This functionality also applies to the code SAM Pro uses to generate the 
 XML file used by the xmltopdf.jar file so that .PDF’s are also generated 
 correctly.</p>
<h2>Related Registry Entries:</h2>
<p>See <a href="Registry_Entry_Global_Settings__Column_Compression__Dispatch_Board_Rows__History_Log_Inventory_Markup.htm#Registry_Entry_Global_Setting_Temp_Directory">the 
 sys-ffv-global-settings option</a> to create a temporary local directory 
 to be used for report saving in case of network interrupts.</p>
<p>See <a href="Registry_Document_Attachments_to_Additional_Tables.htm">Registry 
 - Document Attachments to Additional Tables</a> for specifying additional 
 tables references on a viewer-by-viewer basis.</p>
<p>See <a href="Registry_Start_Document_Archive_Maintenance.htm">Registry 
 Start Document Archive Maintenance</a> for defaults for this function. 
 It enables existing documents to be transferred to subfolders. This function 
 also enables the conversion of DBR reports to PDF’s for use with the Java-bases 
 DBAnalytics and CRMAnywhere.</p>
<p>The registry setting described in <a href="Registry_Entry_Global_Settings__Column_Compression__Dispatch_Board_Rows__History_Log_Inventory_Markup.htm#global_settings_allow_pdfs_dbrs_to_coexist">Global 
 Settings: PDF&#39;s and DBR&#39;s</a> allows the DBR and the PDF versions of saved 
 reports to co-exist: SAM Pro users access reports via the DB Reports viewer, 
 while DBAnalytics/FMAnywhere users view the PDF from within the browser.</p>
<h2>Important Fields:</h2>
<p class="Tip_Note_Heading" style="margin-top: 4.00pt;">Id: <font style="font-weight: normal;">sys-document-archive</font><font style="font-style: italic; font-weight: normal;">-</font><font style="font-style: italic;">branchid-userid</font></p>
<p class="Tip_Note_Heading" style="margin-top: 4.00pt;">(or <font style="font-weight: normal;">sys-document-archive</font><font style="font-style: italic; font-weight: normal;">--userid</font> if 
 branches are not implemented)</p>
<p>sys-document-archive<font style="font-style: italic;">-securityid</font></p>
<p>sys-document-archive</p>
<p>The first format enables you to specify archiving/scanning parameters 
 by branch id and/or user. A branch must be specified if a user belongs 
 to a branch. If branches are not implement, two dashes (not separated 
 by a space) must precede the user id.</p>
<p>The second format enables you specify parameters by security id.</p>
<p>The third format would apply to all users unless another registry entry 
 was created for their security or branch/user id.</p>
<h3>Directory Locations</h3>
<p><font style="font-weight: bold;">Setting Key:</font> directory <font style="font-weight: bold;">Setting Value:</font> <font style="font-weight: bold; 
															 font-style: italic;"><span style="font-weight: normal;">aDirectoryPathName</span><br/>
</font>This entry is required, and defines the directory where all document 
 archives are stored.</p>
<p><font style="font-weight: bold;">Setting Key:</font> scandirectory <font style="font-weight: bold;">SettingValue:</font> <font style="font-weight: bold; 
															 font-style: italic;"><span style="font-weight: normal;">ScanDirectoryPathName</span><br/>
</font>This is the local directory where the scan is stored.</p>
<h3>Scan Parameters For Acquire</h3>
<p><font style="font-weight: bold;">Setting Key:</font> defaultscanparms 
 <font style="font-weight: bold;">Setting Value:</font> <font style="font-style: italic;">parameters</font></p>
<p>This optional entry enables you to set the parameters used by the acquire.exe 
 program used for scanning. If the entry is not implemented, the default 
 parameters are /Hide /Scan: the document will be scanned without bringing 
 up the scanner driver box. Run Acquire.exe from the command prompt for 
 a list of all parameters available. If you wish to specify other parameters, 
 be sure to also include Data-Basics’ defaults:</p>
<p class="Body_Text_Indent" style="margin-left: 72.00pt;"><font style="font-weight: bold; 
	 text-decoration: underline; ">Example</font><font style="font-weight: bold;"><br/>
</font>Setting Key: defaultscanparms Setting Value: /scan /hide /rgb</p>
<h3>Multiple Page PDF Scanning in SAMPro for Acquire</h3>
<p>Recent versions of SAM Pro support multiple-page PDF scanning at least 
 some sheet-feed scanners. Thus far, this functionality has been tested 
 on the Xerox DocuMate 515, the Xerox DocuMate 150, and the Dell v515W.</p>
<p>1. To accomplish this, a Twain driver compatible with the user’s operating 
 system must first be downloaded and installed on the user’s computer.</p>
<p>2. Next, the following registry option should be set in sys-ffv-global-settings:</p>
<p>Setting Key: StoreDocumentsAsPDF Setting Value: true</p>
<p>3. If all users will be employing a sheet feed scanner, your sys-document-archive 
 registry should include the following parameter setting in addition to 
 the other required settings:</p>
<p>Setting Key: defaultscanparms Setting Value: /SCAN /FEEDER /PDF+</p>
<p>4. If some of your employee have sheet feed scanners, and others do 
 not, you will need to make multiple Document Archive registry entries.</p>
<p style="margin-left: 36.00pt;"><font style="text-decoration: underline; ">Example:</font></p>
<p style="margin-left: 36.00pt;">Assume most employees have sheet feed 
 scanners, but user MARYANN has an older flatbed model. In this case, the 
 base registry entry sys-document-archive would be as shown in step to. 
 To support user MARYANN, the above entry would be cloned as sys-document-archive--MARYANN 
 (or sys-document-archive-Branch1-MARYANN if branches are used) and the 
 defaultscanparms option Disabled.</p>
<h3>Scan Settings for NAPS2</h3>
<p>See <a href="Scan_With_NAPS2.htm">Scan With NAPS2</a>  for the 
 registry settings and setup needed for this functionality.</p>
<h3>Control Setting of Read-Only Attribute on Archived Files</h3>
<p>The read-only file attribute is now set on archived documents (this 
 does not apply to report-type documents that get auto-created while running 
 SAMPRO). The following registry option provides SAMPRO users with some 
 control over how the read-only attribute is applied.<br/>
<font style="font-weight: bold;">Setting Key:</font> SetReadOnly<br/>
<font style="font-weight: bold;">Setting Values:</font> All - (Set readOnly 
 on all archive documents) (default)<br/>
              None 
 - do not set read only flag on archive documents.<br/>
              (lists 
 of Extensions delimited by commas)<br/>
              ie 
 pdf,dbr,txt - any extension on this list will be set to<br/>
                              read 
 only.</p>
<h3>Subfolders Option for Document Archiving</h3>
<p><font style="font-weight: bold;">Setting Key:</font> UseSubdirectories 
 <font style="font-weight: bold;">Setting Value:</font> true</p>
<p>Implementing this option results in the archived document being put 
 into the appropriate YYYY-MM subfolder.</p>
<p><font style="font-weight: bold;">See Also:<br/>
</font><a href="Document_Viewer.htm">Attachments</a>  <a href="Scanning_Documents.htm">Scanning 
 Documents</a></p>

</body></html>